(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    105440,       2385]
NotebookOptionsPosition[    101043,       2311]
NotebookOutlinePosition[    101572,       2330]
CellTagsIndexPosition[    101529,       2327]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.895223579135977*^9, 3.8952235816150465`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"a675de87-14d1-4229-a029-a4bf07f08cf7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Read", " ", "Data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Average", " ", "daily", " ", "flux"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"stocks14", "=", 
     RowBox[{
     "Import", "[", 
      "\"\<Marine Pollution\\\\Data\\\\annual_mean_plastic_stock_2014.csv \
\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Number", " ", "of", " ", "households"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HH", "=", 
     RowBox[{
      RowBox[{"10", "^", "6"}], "*", 
      RowBox[{"{", 
       RowBox[{"28.535", ",", "128.45"}], "}"}]}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
        "million", " ", "households", " ", "in", " ", "the", " ", "UK", " ", 
         "and", " ", "US", " ", 
         RowBox[{"https", ":"}]}], "//", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"www", ".", "statista", ".", "com"}], "/", 
             "statistics"}], "/", "183635"}], "/", "number"}], "-", "of", "-",
           "households", "-", "in", "-", "the", "-", "us"}], "/;"}]}], " ", "//", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"www", ".", "statista", ".", "com"}], "/", "statistics"}],
            "/", "806241"}], "/", "number"}], "-", "of", "-", "households", 
         "-", "in", "-", "the", "-", "population", "-", 
         RowBox[{"uk", "/", "#"}]}], ":", 
        RowBox[{"~", 
         RowBox[{":", "text"}]}]}]}], "=", 
      RowBox[{
      "The", "%20", "decile", "%20", "groups", "%20", "with", "%20", "the", 
       "%20", "largest", "%20", "number", "%20", "of"}]}], ",", 
     RowBox[{
     "United", "%20", "Kingdom", "%20", "%28", "UK", "%29", "%20", "reached", 
      "%2028", ".535", "%20", "million", "%20", "in", 
      RowBox[{"%202020", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "Emissions", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"emissionsData", "=", 
     RowBox[{
     "Import", "[", 
      "\"\<Marine Pollution\\\\Data\\\\emissions_totals.csv\>\"", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"national", " ", "income"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GNIraw", "=", 
     RowBox[{
     "Import", "[", 
      "\"\<Marine Pollution\\\\transfer matrix\\\\GNIPPP.csv\>\"", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"willingness", " ", "to", " ", "pay", " ", "data"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WTP", "=", 
     RowBox[{"HH", "*", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.510", "+", "1.559"}], ",", 
          RowBox[{"2.252", "+", "2.196"}]}], "}"}], "/", "0.01"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"0.01", "/", "2"}]}], ")"}]}]}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"/", "0.01"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"0.01", "/", "2"}]}], ")"}]}], " ", "converts", " ", "from", 
      " ", "WTP", " ", "for", " ", "1", "%", " ", "abatement", " ", "to", " ",
       "b"}], "*)"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8876982387384534`*^9, 3.8876982622737536`*^9}, {
   3.887698419065098*^9, 3.8876984500141554`*^9}, {3.8876987573744135`*^9, 
   3.8876988064644213`*^9}, 3.887698857194348*^9, 3.8876989036794496`*^9, {
   3.887699042099623*^9, 3.887699044014588*^9}, {3.8876991668998814`*^9, 
   3.8876992274548154`*^9}, {3.8876994979754534`*^9, 3.887699498175337*^9}, {
   3.88771029485231*^9, 3.8877103028049574`*^9}, {3.8877110940637026`*^9, 
   3.8877110974236107`*^9}, {3.887711871954838*^9, 3.8877118823349123`*^9}, {
   3.8879601783684955`*^9, 3.8879601917518454`*^9}, 3.8879791756459904`*^9, {
   3.8879804957299376`*^9, 3.887980496075536*^9}, {3.890199312804576*^9, 
   3.890199425511063*^9}, {3.890199510237747*^9, 3.8901995156357594`*^9}, {
   3.890199621861424*^9, 3.8901996651385765`*^9}, {3.890199712200327*^9, 
   3.8901997608522477`*^9}, {3.890201001721509*^9, 3.890201009979136*^9}, {
   3.8902096332897177`*^9, 3.890209636816289*^9}, {3.8902098851938396`*^9, 
   3.8902098863517375`*^9}, {3.8902136934297943`*^9, 
   3.8902137054739304`*^9}, {3.890469971843724*^9, 3.8904700248911457`*^9}, {
   3.8904700716220317`*^9, 3.8904700840271597`*^9}, {3.890470119491496*^9, 
   3.8904701304595118`*^9}, {3.8904701630689917`*^9, 3.890470168370253*^9}, {
   3.8904702059348884`*^9, 3.890470209547109*^9}, {3.890470240894024*^9, 
   3.8904703602144656`*^9}, 3.890470641958085*^9, {3.8904708348196015`*^9, 
   3.8904708350078115`*^9}, {3.8904712298496504`*^9, 
   3.8904712334763346`*^9}, {3.890471788704232*^9, 3.890471823921446*^9}, {
   3.8904718719884057`*^9, 3.8904719625320296`*^9}, {3.890472476685852*^9, 
   3.890472486258442*^9}, 3.890472533001001*^9, {3.8904736396680527`*^9, 
   3.890473641059187*^9}, {3.890473797308303*^9, 3.890473804447538*^9}, {
   3.890474419219784*^9, 3.890474434121977*^9}, {3.890474492910393*^9, 
   3.890474520411951*^9}, {3.8904803711468835`*^9, 3.8904803824317408`*^9}, 
   3.8905505902897205`*^9, {3.8905553964918027`*^9, 3.8905554199599895`*^9}, {
   3.890556619903129*^9, 3.890556640350206*^9}, {3.8905566712146597`*^9, 
   3.89055667418517*^9}, 3.890558187993229*^9, 3.8905601690113525`*^9, 
   3.89056033261914*^9, {3.8905613006183896`*^9, 3.8905613183196793`*^9}, {
   3.8905726784889326`*^9, 3.8905726836933985`*^9}, {3.8906199715904984`*^9, 
   3.890619981790036*^9}, 3.8906243903471193`*^9, {3.8906259847072644`*^9, 
   3.8906259851230583`*^9}, {3.8906278336309323`*^9, 
   3.8906278349385195`*^9}, {3.8906319204190493`*^9, 
   3.8906319230813503`*^9}, {3.890637160816641*^9, 3.890637172499331*^9}, {
   3.8906372672672887`*^9, 3.8906372946632543`*^9}, {3.8906394142790403`*^9, 
   3.890639424306838*^9}, {3.8906424137280016`*^9, 3.890642416593618*^9}, {
   3.8906427550112343`*^9, 3.8906427666490297`*^9}, {3.8906462089395795`*^9, 
   3.8906462100462384`*^9}, {3.890649488970151*^9, 3.890649509227581*^9}, 
   3.8906561739237523`*^9, {3.890703398591913*^9, 3.890703400135942*^9}, {
   3.892032805136959*^9, 3.892032808663517*^9}, {3.8920329731341534`*^9, 
   3.892032996226568*^9}, {3.8920331961644554`*^9, 3.8920331963252463`*^9}, {
   3.8930773652165627`*^9, 3.8930773986202726`*^9}, {3.893077488727441*^9, 
   3.8930775334492617`*^9}, {3.8930775795315795`*^9, 
   3.8930775882008715`*^9}, {3.8930795491883135`*^9, 3.893079588292392*^9}, {
   3.8930796194091387`*^9, 3.8930796526779013`*^9}, {3.893080123947031*^9, 
   3.893080149936584*^9}, {3.8930801838785615`*^9, 3.8930801982864485`*^9}, {
   3.893080272581662*^9, 3.89308027373637*^9}, {3.8931476695165777`*^9, 
   3.8931476967616787`*^9}, {3.89375830667559*^9, 3.8937583457468643`*^9}, 
   3.893758393743309*^9, {3.8937589166860723`*^9, 3.8937589206186624`*^9}, 
   3.893759091983653*^9, 3.8937592453258667`*^9, 3.89375929102617*^9, 
   3.8939972797745214`*^9, {3.893997317035013*^9, 3.893997334366355*^9}, {
   3.894006457344615*^9, 3.8940065413423944`*^9}, {3.8952234413340073`*^9, 
   3.895223452108841*^9}, {3.8952236007782197`*^9, 3.895223625337643*^9}, {
   3.9196867105731106`*^9, 3.9196867105751123`*^9}, 3.9204512649531612`*^9},
 CellLabel->"In[65]:=",ExpressionUUID->"9b579936-886d-49da-aebe-dc5cb9b83a7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"country", " ", "names"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"names", "=", 
     RowBox[{"emissionsData", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "All"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NN", "=", 
     RowBox[{"Length", "[", "names", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"countryNames", "=", 
     RowBox[{"Replace", "[", 
      RowBox[{"names", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
         "\"\<Dominican Rep.\>\"", "\[Rule]", " ", 
          "\"\<Dominican Republic\>\""}], ",", 
         RowBox[{
         "\"\<United Kingdom\>\"", "\[Rule]", "\"\<United Kingdom\>\""}], ",", 
         RowBox[{
         "\"\<United States of America\>\"", "\[Rule]", 
          "\"\<United States\>\""}]}], "}"}], ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"National", " ", "income"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GNI", "=", 
     RowBox[{
      RowBox[{"N", "@", 
       RowBox[{"GNIraw", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Transpose", "@", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"GNIraw", ",", "#"}], "]"}], "&"}], "/@", 
                "countryNames"}], ",", "1"}], "]"}]}], ")"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"GNIraw", ",", "2021"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], "/", 
      RowBox[{"10", "^", "9"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Income", " ", "elasticity"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"epsilon", "=", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{
        RowBox[{"WTP", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/", 
        RowBox[{"WTP", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "/", 
      RowBox[{"Log", "[", 
       RowBox[{
        RowBox[{"GNI", "[", 
         RowBox[{"[", 
          RowBox[{"-", "2"}], "]"}], "]"}], "/", 
        RowBox[{"GNI", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Size", " ", "of", " ", "the", " ", "problem"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"W", "=", 
     RowBox[{"Total", "@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"GNI", "^", "epsilon"}], "/", 
         RowBox[{
          RowBox[{"GNI", "[", 
           RowBox[{"[", 
            RowBox[{"-", "2"}], "]"}], "]"}], "^", "epsilon"}]}], "*", 
        RowBox[{
         RowBox[{"WTP", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/", "2"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "emissions", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"e", "=", 
     RowBox[{"emissionsData", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "All"}], "]"}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"Transition", " ", "matricies"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EE", "=", 
     RowBox[{"Transpose", "@", 
      RowBox[{"stocks14", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"2", ";;", "17"}], ",", 
         RowBox[{"2", ";;", "17"}]}], "]"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T", "=", 
     RowBox[{"N", "@", 
      RowBox[{"(", 
       RowBox[{"EE", "/", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Total", "@", "EE"}], ",", "NN"}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"benefits", " ", "and", " ", "costs"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"b", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"N", "@", "GNI"}], "^", "epsilon"}], "/", 
      RowBox[{"Total", "@", 
       RowBox[{"(", 
        RowBox[{"GNI", "^", "epsilon"}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c", "=", 
     RowBox[{"2", "*", "b", "*", 
      RowBox[{"Diagonal", "[", "T", "]"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8876982387384534`*^9, 3.8876982622737536`*^9}, {
   3.887698419065098*^9, 3.8876984500141554`*^9}, {3.8876987573744135`*^9, 
   3.8876988064644213`*^9}, 3.887698857194348*^9, 3.8876989036794496`*^9, {
   3.887699042099623*^9, 3.887699044014588*^9}, {3.8876991668998814`*^9, 
   3.8876992274548154`*^9}, {3.8876994979754534`*^9, 3.887699498175337*^9}, {
   3.88771029485231*^9, 3.8877103028049574`*^9}, {3.8877110940637026`*^9, 
   3.8877110974236107`*^9}, {3.887711871954838*^9, 3.8877118823349123`*^9}, {
   3.8879601783684955`*^9, 3.8879601917518454`*^9}, 3.8879791756459904`*^9, {
   3.8879804957299376`*^9, 3.887980496075536*^9}, {3.890199312804576*^9, 
   3.890199425511063*^9}, {3.890199510237747*^9, 3.8901995156357594`*^9}, {
   3.890199621861424*^9, 3.8901996651385765`*^9}, {3.890199712200327*^9, 
   3.8901997608522477`*^9}, {3.890201001721509*^9, 3.890201009979136*^9}, {
   3.8902096332897177`*^9, 3.890209636816289*^9}, {3.8902098851938396`*^9, 
   3.8902098863517375`*^9}, {3.8902136934297943`*^9, 
   3.8902137054739304`*^9}, {3.890469971843724*^9, 3.8904700248911457`*^9}, {
   3.8904700716220317`*^9, 3.8904700840271597`*^9}, {3.890470119491496*^9, 
   3.8904701304595118`*^9}, {3.8904701630689917`*^9, 3.890470168370253*^9}, {
   3.8904702059348884`*^9, 3.890470209547109*^9}, {3.890470240894024*^9, 
   3.8904703602144656`*^9}, 3.890470641958085*^9, {3.8904708348196015`*^9, 
   3.8904708350078115`*^9}, {3.8904712298496504`*^9, 
   3.8904712334763346`*^9}, {3.890471788704232*^9, 3.890471823921446*^9}, {
   3.8904718719884057`*^9, 3.8904719625320296`*^9}, {3.890472476685852*^9, 
   3.890472486258442*^9}, 3.890472533001001*^9, {3.8904736396680527`*^9, 
   3.890473641059187*^9}, {3.890473797308303*^9, 3.890473804447538*^9}, {
   3.890474419219784*^9, 3.890474434121977*^9}, {3.890474492910393*^9, 
   3.890474520411951*^9}, {3.8904803711468835`*^9, 3.8904803824317408`*^9}, 
   3.8905505902897205`*^9, {3.8905553964918027`*^9, 3.8905554199599895`*^9}, {
   3.890556619903129*^9, 3.890556640350206*^9}, {3.8905566712146597`*^9, 
   3.89055667418517*^9}, 3.890558187993229*^9, 3.8905601690113525`*^9, 
   3.89056033261914*^9, {3.8905613006183896`*^9, 3.8905613183196793`*^9}, {
   3.8905726784889326`*^9, 3.8905726836933985`*^9}, {3.8906199715904984`*^9, 
   3.890619981790036*^9}, 3.8906243903471193`*^9, {3.8906259847072644`*^9, 
   3.8906259851230583`*^9}, {3.8906278336309323`*^9, 
   3.8906278349385195`*^9}, {3.8906319204190493`*^9, 
   3.8906319230813503`*^9}, {3.890637160816641*^9, 3.890637172499331*^9}, {
   3.8906372672672887`*^9, 3.8906372946632543`*^9}, {3.8906394142790403`*^9, 
   3.890639424306838*^9}, {3.8906424137280016`*^9, 3.890642416593618*^9}, {
   3.8906427550112343`*^9, 3.8906427666490297`*^9}, {3.8906462089395795`*^9, 
   3.8906462100462384`*^9}, {3.890649488970151*^9, 3.890649509227581*^9}, 
   3.8906561739237523`*^9, {3.890703398591913*^9, 3.890703400135942*^9}, {
   3.892032805136959*^9, 3.892032808663517*^9}, {3.8920329731341534`*^9, 
   3.892032996226568*^9}, {3.8920331961644554`*^9, 3.8920331963252463`*^9}, {
   3.8930773652165627`*^9, 3.8930773986202726`*^9}, {3.893077488727441*^9, 
   3.8930775334492617`*^9}, {3.8930775795315795`*^9, 
   3.8930775882008715`*^9}, {3.8930795491883135`*^9, 3.893079588292392*^9}, {
   3.8930796194091387`*^9, 3.8930796526779013`*^9}, {3.893080123947031*^9, 
   3.893080149936584*^9}, {3.8930801838785615`*^9, 3.8930801982864485`*^9}, {
   3.893080272581662*^9, 3.89308027373637*^9}, {3.8931476695165777`*^9, 
   3.8931476967616787`*^9}, {3.89375830667559*^9, 3.8937583457468643`*^9}, 
   3.893758393743309*^9, {3.8937589166860723`*^9, 3.8937589206186624`*^9}, 
   3.893759091983653*^9, 3.8937592453258667`*^9, 3.89375929102617*^9, 
   3.8939972797745214`*^9, {3.893997317035013*^9, 3.893997334366355*^9}, {
   3.894006457344615*^9, 3.8940065192234964`*^9}, {3.894006586365059*^9, 
   3.894006635397663*^9}, {3.89400667182275*^9, 3.8940067585723534`*^9}, {
   3.8952234678930526`*^9, 3.895223556916089*^9}, {3.9195960968124037`*^9, 
   3.919596102083078*^9}, {3.9195974690200405`*^9, 3.9195974718534613`*^9}, {
   3.9195975507086687`*^9, 3.919597558464922*^9}, {3.9195975976842537`*^9, 
   3.9195975980689783`*^9}, {3.9195983721581297`*^9, 
   3.9195983797942734`*^9}, {3.9195984421204367`*^9, 3.919598446903516*^9}, {
   3.919598525584949*^9, 3.9195985395604725`*^9}, {3.9196867105820885`*^9, 
   3.9196867589763284`*^9}, {3.920451299498181*^9, 3.920451299919078*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"5cd9e40e-2e85-4ce0-abd1-f17664df92e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"abatement", " ", "choice", " ", "variable"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "=", 
     RowBox[{"Array", "[", 
      RowBox[{"aa", ",", "NN"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"first", " ", "order", " ", "condition"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"grandFOC", "[", 
      RowBox[{"a_", ",", "T_", ",", "b_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"b", "*", 
        RowBox[{"Diagonal", "@", "T"}]}], "-", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "a"}], ")"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"b", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{"1", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Dimensions", "@", "T"}], ")"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "-", 
             RowBox[{"a", ".", "T"}]}], ")"}]}], ")"}], ".", 
         RowBox[{"Transpose", "@", "T"}]}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "values", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"VV", "[", 
      RowBox[{"a_", ",", "T_", ",", "b_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"b", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", ".", "T"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"2", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Dimensions", "@", "T"}], ")"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"a", ".", "T"}]}], ")"}]}], ")"}]}], "+", 
      RowBox[{"2", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "*", 
          RowBox[{"Diagonal", "@", "T"}]}], ")"}], ".", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", "a"}], "]"}]}]}]}]}], " ", ";", 
    RowBox[{
     RowBox[{"vv", "[", 
      RowBox[{"a_", ",", "T_", ",", "b_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"b", "*", 
       RowBox[{"a", ".", "T"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"2", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Dimensions", "@", "T"}], ")"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "-", 
         RowBox[{"a", ".", "T"}]}], ")"}]}], "+", 
      RowBox[{"2", "*", "b", "*", 
       RowBox[{"Diagonal", "@", "T"}], "*", 
       RowBox[{"Log", "[", 
        RowBox[{"1", "-", "a"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"derivative", " ", "wrt", " ", "T", " ", "and", " ", "E"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DVDT", "[", 
      RowBox[{"a_", ",", "T_"}], "]"}], ":=", 
     RowBox[{"2", "*", "b", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "@", 
          RowBox[{"{", "a", "}"}]}], ".", 
         RowBox[{"{", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"a", ".", "T"}]}], ")"}], "}"}]}], "+", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"Log", "[", 
          RowBox[{"1", "-", "a"}], "]"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DVDE", "[", 
      RowBox[{"a_", ",", "T_", ",", "E_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DVDT", "[", 
         RowBox[{"a", ",", "T"}], "]"}], "-", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Diagonal", "[", 
           RowBox[{
            RowBox[{"DVDT", "[", 
             RowBox[{"a", ",", "T"}], "]"}], ".", 
            RowBox[{"Transpose", "[", "T", "]"}]}], "]"}], ",", 
          RowBox[{"Length", "@", "a"}]}], "]"}]}], ")"}], "/", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Total", "[", "E", "]"}], ",", 
        RowBox[{"Length", "@", "a"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"elasticities", " ", "wrt", " ", "E"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dlVdlE", "[", 
     RowBox[{"a_", ",", "T_", ",", "E_", ",", "b_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"DVDE", "[", 
      RowBox[{"a", ",", "T", ",", "E"}], "]"}], "*", 
     RowBox[{"E", "/", 
      RowBox[{"VV", "[", 
       RowBox[{"a", ",", "T", ",", "b"}], "]"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.8876982387384534`*^9, 3.8876982622737536`*^9}, {
   3.887698419065098*^9, 3.8876984500141554`*^9}, {3.8876987573744135`*^9, 
   3.8876988064644213`*^9}, 3.887698857194348*^9, 3.8876989036794496`*^9, {
   3.887699042099623*^9, 3.887699044014588*^9}, {3.8876991668998814`*^9, 
   3.8876992274548154`*^9}, {3.8876994979754534`*^9, 3.887699498175337*^9}, {
   3.88771029485231*^9, 3.8877103028049574`*^9}, {3.8877110940637026`*^9, 
   3.8877110974236107`*^9}, {3.887711871954838*^9, 3.8877118823349123`*^9}, {
   3.8879601783684955`*^9, 3.8879601917518454`*^9}, 3.8879791756459904`*^9, {
   3.8879804957299376`*^9, 3.887980496075536*^9}, {3.890199312804576*^9, 
   3.890199425511063*^9}, {3.890199510237747*^9, 3.8901995156357594`*^9}, {
   3.890199621861424*^9, 3.8901996651385765`*^9}, {3.890199712200327*^9, 
   3.8901997608522477`*^9}, {3.890201001721509*^9, 3.890201009979136*^9}, {
   3.8902096332897177`*^9, 3.890209636816289*^9}, {3.8902098851938396`*^9, 
   3.8902098863517375`*^9}, {3.8902136934297943`*^9, 
   3.8902137054739304`*^9}, {3.890469971843724*^9, 3.8904700248911457`*^9}, {
   3.8904700716220317`*^9, 3.8904700840271597`*^9}, {3.890470119491496*^9, 
   3.8904701304595118`*^9}, {3.8904701630689917`*^9, 3.890470168370253*^9}, {
   3.8904702059348884`*^9, 3.890470209547109*^9}, {3.890470240894024*^9, 
   3.8904703602144656`*^9}, 3.890470641958085*^9, {3.8904708348196015`*^9, 
   3.8904708350078115`*^9}, {3.8904712298496504`*^9, 
   3.8904712334763346`*^9}, {3.890471788704232*^9, 3.890471823921446*^9}, {
   3.8904718719884057`*^9, 3.8904719625320296`*^9}, {3.890472476685852*^9, 
   3.890472486258442*^9}, 3.890472533001001*^9, {3.8904736396680527`*^9, 
   3.890473641059187*^9}, {3.890473797308303*^9, 3.890473804447538*^9}, {
   3.890474419219784*^9, 3.890474434121977*^9}, {3.890474492910393*^9, 
   3.890474520411951*^9}, {3.8904803711468835`*^9, 3.8904803824317408`*^9}, 
   3.8905505902897205`*^9, {3.8905553964918027`*^9, 3.8905554199599895`*^9}, {
   3.890556619903129*^9, 3.890556640350206*^9}, {3.8905566712146597`*^9, 
   3.89055667418517*^9}, 3.890558187993229*^9, 3.8905601690113525`*^9, 
   3.89056033261914*^9, {3.8905613006183896`*^9, 3.8905613183196793`*^9}, {
   3.8905726784889326`*^9, 3.8905726836933985`*^9}, {3.8906199715904984`*^9, 
   3.890619981790036*^9}, 3.8906243903471193`*^9, {3.8906259847072644`*^9, 
   3.8906259851230583`*^9}, {3.8906278336309323`*^9, 
   3.8906278349385195`*^9}, {3.8906319204190493`*^9, 
   3.8906319230813503`*^9}, {3.890637160816641*^9, 3.890637172499331*^9}, {
   3.8906372672672887`*^9, 3.8906372946632543`*^9}, {3.8906394142790403`*^9, 
   3.890639424306838*^9}, {3.8906424137280016`*^9, 3.890642416593618*^9}, {
   3.8906427550112343`*^9, 3.8906427666490297`*^9}, {3.8906462089395795`*^9, 
   3.8906462100462384`*^9}, {3.890649488970151*^9, 3.890649509227581*^9}, 
   3.8906561739237523`*^9, {3.890703398591913*^9, 3.890703400135942*^9}, {
   3.892032805136959*^9, 3.892032808663517*^9}, {3.8920329731341534`*^9, 
   3.892032996226568*^9}, {3.8920331961644554`*^9, 3.8920331963252463`*^9}, {
   3.8930773652165627`*^9, 3.8930773986202726`*^9}, {3.893077488727441*^9, 
   3.8930775334492617`*^9}, {3.8930775795315795`*^9, 
   3.8930775882008715`*^9}, {3.8930795491883135`*^9, 3.893079588292392*^9}, {
   3.8930796194091387`*^9, 3.8930796526779013`*^9}, {3.893080123947031*^9, 
   3.893080149936584*^9}, {3.8930801838785615`*^9, 3.8930801982864485`*^9}, {
   3.893080272581662*^9, 3.89308027373637*^9}, {3.8931476695165777`*^9, 
   3.8931476967616787`*^9}, {3.89375830667559*^9, 3.8937583457468643`*^9}, 
   3.893758393743309*^9, {3.8937589166860723`*^9, 3.8937589206186624`*^9}, 
   3.893759091983653*^9, 3.8937592453258667`*^9, {3.8939973752647815`*^9, 
   3.893997375663975*^9}, {3.8940053758150263`*^9, 3.8940053914371443`*^9}, {
   3.894005434007679*^9, 3.894005458987581*^9}, 3.894006702425708*^9, {
   3.8940067686967916`*^9, 3.894006798770255*^9}, {3.895223644824557*^9, 
   3.89522364756822*^9}, {3.919597607086488*^9, 3.9195976270041337`*^9}, 
   3.919597706739505*^9, {3.9195977504769173`*^9, 3.919597861041564*^9}, {
   3.919597984532797*^9, 3.9195980835713367`*^9}, {3.9195981144050055`*^9, 
   3.9195981546643305`*^9}, {3.91959819433774*^9, 3.919598236839711*^9}, {
   3.9195983226093655`*^9, 3.919598367387845*^9}, 3.919598684919141*^9, 
   3.9195987497959595`*^9, {3.9196021057301903`*^9, 3.9196021059631815`*^9}, {
   3.919613414869375*^9, 3.9196134194002857`*^9}, {3.919686016149953*^9, 
   3.9196860164320955`*^9}, {3.919686050116992*^9, 3.919686050511072*^9}, 
   3.9196865620923*^9, 3.91968671059918*^9, {3.920604176547001*^9, 
   3.920604212256893*^9}, {3.920604244921662*^9, 3.920604251564534*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"44fbf54b-5c0d-45a7-9128-3fadd566568f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"baseline", " ", "problem"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"a0", "=", 
    RowBox[{
     RowBox[{"FindRoot", "[", 
      RowBox[{
       RowBox[{"grandFOC", "[", 
        RowBox[{"a", ",", "T", ",", "b"}], "]"}], ",", 
       RowBox[{"Transpose", "@", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"Transpose", "@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0.9", ",", 
                 RowBox[{"-", "2"}], ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}]}]}], 
           "}"}], ",", "1"}], "]"}]}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8906422194393773`*^9, 3.8906422251784406`*^9}, {
   3.890642267737856*^9, 3.8906422799701643`*^9}, 3.8906561815400047`*^9, 
   3.890884447385405*^9, {3.8940068059228735`*^9, 3.894006806862595*^9}, {
   3.919598417237506*^9, 3.91959842216392*^9}, {3.9195984619094105`*^9, 
   3.9195984620939198`*^9}, 3.919686466484576*^9},
 CellLabel->"In[87]:=",ExpressionUUID->"373153d2-7bc2-44c1-b98f-8cd08ff34fec"],

Cell[CellGroupData[{

Cell[BoxData["a0"], "Input",
 CellChangeTimes->{{3.9334067613772945`*^9, 3.9334067615762873`*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"b0008732-c2a7-43d8-a7cf-02354bf8962c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.7319906777276931`", ",", "0.13610535350080058`", ",", 
   "0.7272103472056635`", ",", "0.0306968581529825`", ",", 
   RowBox[{"-", "0.1966110254170591`"}], ",", "0.9354252785092855`", ",", 
   "0.9945129539672705`", ",", "0.5064891565206726`", ",", 
   "0.3899089761770943`", ",", "0.5727959777649129`", ",", 
   "0.7301132094154397`", ",", "0.646431365061591`", ",", 
   "0.4024666176980082`", ",", 
   RowBox[{"-", "0.052700000137494325`"}], ",", "0.1996300865166978`", ",", 
   RowBox[{"-", "0.427333903542141`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9334067623022947`*^9, 3.933407043198196*^9},
 CellLabel->"Out[88]=",ExpressionUUID->"1e4f9f7c-73e4-493e-b13a-43a3ebcc2c48"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Display", " ", "results"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dp", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"resultsBase", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Name\>\"", ",", "\"\<e\>\"", ",", "\"\<S\>\"", ",", "\"\<b\>\"",
           ",", "\"\<c\>\"", ",", "\"\<a\>\"", ",", "\"\<A\>\"", ",", 
          "\"\<v\>\"", ",", "\"\<$bn\>\"", ",", " ", "\"\<v/V\>\""}], "}"}], 
        "}"}], ",", 
       RowBox[{"Transpose", "@", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Append", "[", 
            RowBox[{"countryNames", ",", "\"\<Total\>\""}], "]"}], "}"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{"e", ",", 
               RowBox[{"Total", "@", "e"}]}], "]"}], ",", "0.01"}], "]"}], 
           "}"}], ",", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"100", "*", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"Diagonal", "[", "T", "]"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Append", "[", 
                RowBox[{"b", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Append", "[", 
                RowBox[{"c", ",", 
                 RowBox[{"Total", "@", "c"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Append", "[", 
                RowBox[{"a0", ",", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"a0", ".", "EE"}], "]"}], "/", 
                  RowBox[{"Total", "@", 
                   RowBox[{"Total", "@", "EE"}]}]}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"a0", ".", "T"}], ",", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"a0", ".", "EE"}], "]"}], "/", 
                  RowBox[{"Total", "@", 
                   RowBox[{"Total", "@", "EE"}]}]}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"vv", "[", 
                  RowBox[{"a0", ",", "T", ",", "b"}], "]"}], ",", 
                 RowBox[{"VV", "[", 
                  RowBox[{"a0", ",", "T", ",", "b"}], "]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"vv", "[", 
                   RowBox[{"a0", ",", "T", ",", "b"}], "]"}], ",", 
                  RowBox[{"VV", "[", 
                   RowBox[{"a0", ",", "T", ",", "b"}], "]"}]}], "]"}], "*", 
                RowBox[{"W", "/", 
                 RowBox[{"10", "^", "11"}]}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"vv", "[", 
                   RowBox[{"a0", ",", "T", ",", "b"}], "]"}], "/", 
                  RowBox[{"VV", "[", 
                   RowBox[{"a0", ",", "T", ",", "b"}], "]"}]}], ",", "1"}], 
                "]"}]}], "}"}]}], ",", "dp"}], "]"}]}], "]"}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "@", "resultsBase"}]}]}]], "Input",
 CellChangeTimes->{{3.890642249883223*^9, 3.890642390818802*^9}, {
   3.8906424393788986`*^9, 3.890642519093916*^9}, {3.8906425612865257`*^9, 
   3.890642567200254*^9}, {3.890642623078153*^9, 3.8906426381820245`*^9}, {
   3.8906427795682025`*^9, 3.8906428144372683`*^9}, {3.8906428780307293`*^9, 
   3.890642879411446*^9}, {3.89064292760155*^9, 3.890643003757684*^9}, {
   3.890643051724152*^9, 3.890643061219614*^9}, {3.8906561886785493`*^9, 
   3.89065620318025*^9}, {3.890657243052097*^9, 3.8906572486300592`*^9}, {
   3.890884466104289*^9, 3.890884466782754*^9}, {3.8909181480655613`*^9, 
   3.8909181687134647`*^9}, {3.890998758636013*^9, 3.890998760881229*^9}, {
   3.8910053250942593`*^9, 3.8910053269772797`*^9}, {3.8931476967751074`*^9, 
   3.8931477186260967`*^9}, {3.893758225813816*^9, 3.893758238703535*^9}, {
   3.8937582909818*^9, 3.8937582973184333`*^9}, {3.8940054692195697`*^9, 
   3.8940054841028643`*^9}, 3.894005586630702*^9, {3.894005632912139*^9, 
   3.8940056445500565`*^9}, {3.8952236623144393`*^9, 
   3.8952237991905484`*^9}, {3.895223849347288*^9, 3.8952238744991183`*^9}, {
   3.895223999997568*^9, 3.8952240355132933`*^9}, {3.8952242561710176`*^9, 
   3.8952242700050297`*^9}, {3.919598506165983*^9, 3.9195985158324957`*^9}, {
   3.919598549035491*^9, 3.919598625204333*^9}, {3.919686476806602*^9, 
   3.9196864896649594`*^9}, {3.919686523894743*^9, 3.9196865270843024`*^9}, {
   3.9196867106031537`*^9, 3.9196867589783387`*^9}, 3.927882891253707*^9},
 CellLabel->"In[89]:=",ExpressionUUID->"4431e23e-b405-400d-b639-985e04aa39e4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Name\"\>", "\<\"e\"\>", "\<\"S\"\>", "\<\"b\"\>", "\<\"c\"\>", "\<\
\"a\"\>", "\<\"A\"\>", "\<\"v\"\>", "\<\"$bn\"\>", "\<\"v/V\"\>"},
     {"\<\"Belgium\"\>", "31.53`", "8.32`", "1.6500000000000001`", "0.27`", 
      "73.2`", "38.43`", "0.66`", "0.39`", "1.07`"},
     {"\<\"Canada\"\>", "236.69`", "38.980000000000004`", "4.54`", "3.54`", 
      "13.61`", "8.15`", "0.19`", "0.11`", "0.31`"},
     {"\<\"Denmark\"\>", "5.04`", "1.05`", "0.96`", "0.02`", "72.72`", 
      "30.82`", "0.47000000000000003`", "0.28`", "0.76`"},
     {"\<\"France\"\>", "258.55`", "34.11`", "7.87`", "5.37`", 
      "3.0700000000000003`", "32.08`", "4.07`", "2.39`", 
      "6.5600000000000005`"},
     {"\<\"Germany\"\>", "131.69`", "34.25`", "11.`", "7.54`", 
      RowBox[{"-", "19.66`"}], "28.32`", "6.7`", "3.94`", "10.81`"},
     {"\<\"Dominican Republic\"\>", "6026.74`", "94.96000000000001`", "0.54`",
       "1.03`", "93.54`", "92.71000000000001`", 
      RowBox[{"-", "2.2800000000000002`"}], 
      RowBox[{"-", "1.34`"}], 
      RowBox[{"-", "3.67`"}]},
     {"\<\"Haiti\"\>", "6928.6900000000005`", "56.38`", "0.1`", "0.11`", 
      "99.45`", "96.71000000000001`", 
      RowBox[{"-", "0.47000000000000003`"}], 
      RowBox[{"-", "0.28`"}], 
      RowBox[{"-", "0.76`"}]},
     {"\<\"Ireland\"\>", "104.88`", "54.04`", "0.98`", "1.05`", "50.65`", 
      "41.45`", 
      RowBox[{"-", "0.1`"}], 
      RowBox[{"-", "0.06`"}], 
      RowBox[{"-", "0.17`"}]},
     {"\<\"Mexico\"\>", "2217.55`", "32.89`", "5.7`", "3.75`", "38.99`", 
      "69.23`", "3.3000000000000003`", "1.94`", "5.33`"},
     {"\<\"Morocco\"\>", "1836.91`", "91.13`", "0.81`", "1.47`", "57.28`", 
      "57.02`", 
      RowBox[{"-", "0.59`"}], 
      RowBox[{"-", "0.35000000000000003`"}], 
      RowBox[{"-", "0.96`"}]},
     {"\<\"Netherlands\"\>", "265.05`", "48.050000000000004`", "2.61`", 
      "2.5100000000000002`", "73.01`", "47.96`", 
      RowBox[{"-", "1.3800000000000001`"}], 
      RowBox[{"-", "0.81`"}], 
      RowBox[{"-", "2.23`"}]},
     {"\<\"Portugal\"\>", "72.59`", "5.37`", "0.9`", "0.1`", "64.64`", 
      "46.51`", "0.54`", "0.32`", "0.87`"},
     {"\<\"Spain\"\>", "214.21`", "24.53`", "4.46`", "2.19`", "40.25`", 
      "46.39`", "2.05`", "1.2`", "3.31`"},
     {"\<\"Sweden\"\>", "35.67`", "28.26`", "1.53`", "0.86`", 
      RowBox[{"-", "5.2700000000000005`"}], "19.86`", "0.59`", 
      "0.35000000000000003`", "0.9500000000000001`"},
     {"\<\"United Kingdom\"\>", "700.71`", "76.68`", "7.49`", "11.49`", 
      "19.96`", "26.37`", "0.87`", "0.51`", "1.41`"},
     {"\<\"United States\"\>", "2428.7400000000002`", "23.86`", "48.88`", 
      "23.330000000000002`", 
      RowBox[{"-", "42.730000000000004`"}], "55.22`", "47.38`", 
      "27.830000000000002`", "76.41`"},
     {"\<\"Total\"\>", "21495.25`", 
      RowBox[{"{", "}"}], "100.`", "64.63`", "64.25`", "64.25`", "62.01`", 
      "36.42`", "100.`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.89522426003121*^9, 3.895224270473852*^9}, 
   3.8986868830006323`*^9, 3.919414292998786*^9, {3.919598626914113*^9, 
   3.9195986417380757`*^9}, 3.91959875763443*^9, 3.9196864332115664`*^9, {
   3.9196865196927505`*^9, 3.9196865275355005`*^9}, 3.9196865658102894`*^9, 
   3.9204514117820377`*^9, 3.9278831385379305`*^9, 3.9334060070484076`*^9, 
   3.933407043232594*^9},
 CellLabel->
  "Out[91]//MatrixForm=",ExpressionUUID->"93033e9c-9a9f-4440-89cb-\
fab470fe211d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<Marine Pollution\\\\Results\\\\resultsBase.csv\>\"", ",", 
    "resultsBase"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.919686710636257*^9, 3.919686710636257*^9}, {
  3.9278832280951777`*^9, 
  3.927883228503642*^9}},ExpressionUUID->"dacb7170-c524-4360-8a02-\
bd7783a1b9d1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compStat", "=", 
  RowBox[{"MatrixForm", "@", 
   RowBox[{"Transpose", "@", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "\"\<Transport Elasticity\>\"", "}"}], ",", 
         "countryNames", ",", 
         RowBox[{"{", "\"\<Total\>\"", "}"}]}], "]"}], "}"}], ",", 
      RowBox[{"Transpose", "@", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Join", "[", 
           RowBox[{"countryNames", ",", 
            RowBox[{"{", "\"\<Total\>\"", "}"}]}], "]"}], "}"}], ",", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"10", "^", "3"}], "*", 
           RowBox[{"Transpose", "@", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"dlVdlE", "[", 
                  RowBox[{"a0", ",", "T", ",", "EE", ",", "b"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Total", "@", 
                   RowBox[{"dlVdlE", "[", 
                    RowBox[{"a0", ",", "T", ",", "EE", ",", "b"}], "]"}]}], 
                  "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Total", "/@", 
                  RowBox[{"dlVdlE", "[", 
                   RowBox[{"a0", ",", "T", ",", "EE", ",", "b"}], "]"}]}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"Total", "@", 
                   RowBox[{"Total", "@", 
                    RowBox[{"dlVdlE", "[", 
                    RowBox[{"a0", ",", "T", ",", "EE", ",", "b"}], "]"}]}]}], 
                  "}"}]}], "]"}], "}"}]}], "]"}]}]}], "]"}]}], "]"}]}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.919684831648059*^9, 3.919684921779677*^9}, {
  3.919684964818456*^9, 3.9196849742612596`*^9}, {3.9196850155105376`*^9, 
  3.9196850220484576`*^9}, {3.919685231912275*^9, 3.91968523757297*^9}, {
  3.9196853258358345`*^9, 3.9196853673916416`*^9}, {3.9196854032418766`*^9, 
  3.919685554263513*^9}, {3.9196855935978403`*^9, 3.9196856313899527`*^9}, {
  3.919685874981578*^9, 3.9196858863688226`*^9}, {3.91968607746929*^9, 
  3.919686083460311*^9}, {3.919686495378296*^9, 3.919686505107259*^9}, {
  3.9196867106402507`*^9, 3.919686758982338*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"771bee0e-c047-4d43-bffc-7a5b5b2f9f39"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Transport Elasticity\"\>", "\<\"Belgium\"\>", "\<\"Canada\"\>", \
"\<\"Denmark\"\>", "\<\"France\"\>", "\<\"Germany\"\>", "\<\"Dominican \
Republic\"\>", "\<\"Haiti\"\>", "\<\"Ireland\"\>", "\<\"Mexico\"\>", \
"\<\"Morocco\"\>", "\<\"Netherlands\"\>", "\<\"Portugal\"\>", \
"\<\"Spain\"\>", "\<\"Sweden\"\>", "\<\"United Kingdom\"\>", "\<\"United \
States\"\>", "\<\"Total\"\>"},
     {"\<\"Belgium\"\>", 
      RowBox[{"-", "4"}], "0", "1", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", "0", "0", 
      RowBox[{"-", "1"}]},
     {"\<\"Canada\"\>", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "6", "6"},
     {"\<\"Denmark\"\>", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0"},
     {"\<\"France\"\>", "1", "0", "0", 
      RowBox[{"-", "1"}], "1", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0"},
     {"\<\"Germany\"\>", "0", "0", 
      RowBox[{"-", "11"}], "0", "11", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", 
      RowBox[{"-", "12"}], "0", "0", 
      RowBox[{"-", "13"}]},
     {"\<\"Dominican Republic\"\>", "0", "1", "0", "1", "0", 
      RowBox[{"-", "11"}], "3", "1", "6", "0", "0", "2", "1", "0", "0", "129",
       "133"},
     {"\<\"Haiti\"\>", "0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "5"}], "1", "6", "0", "0", "1", "0", "0", 
      RowBox[{"-", "1"}], "158", "161"},
     {"\<\"Ireland\"\>", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "4"}], "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "3"}], "0", 
      RowBox[{"-", "7"}]},
     {"\<\"Mexico\"\>", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "16"}], "0", "0", "0", "0", "0", "0", "56", "39"},
     {"\<\"Morocco\"\>", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "5"}], "0", "0", "3", "0", "0", "7", "7"},
     {"\<\"Netherlands\"\>", "12", "0", "15", "0", "25", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "47"}], "0", "0", "12", "0", "0", "17"},
     {"\<\"Portugal\"\>", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {"\<\"Spain\"\>", "0", "0", "0", "9", "0", "0", "0", "0", "0", "0", "0", 
      "1", 
      RowBox[{"-", "10"}], "0", "0", "0", "0"},
     {"\<\"Sweden\"\>", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0"},
     {"\<\"United Kingdom\"\>", "11", "0", "9", "1", "10", "0", "0", "8", "0",
       "0", "2", "0", "0", "6", 
      RowBox[{"-", "40"}], "0", "6"},
     {"\<\"United States\"\>", 
      RowBox[{"-", "6"}], 
      RowBox[{"-", "247"}], 
      RowBox[{"-", "5"}], 
      RowBox[{"-", "47"}], 
      RowBox[{"-", "3"}], "0", "0", 
      RowBox[{"-", "26"}], 
      RowBox[{"-", "10"}], 
      RowBox[{"-", "5"}], 
      RowBox[{"-", "3"}], 
      RowBox[{"-", "116"}], 
      RowBox[{"-", "34"}], 
      RowBox[{"-", "5"}], 
      RowBox[{"-", "11"}], "171", 
      RowBox[{"-", "348"}]},
     {"\<\"Total\"\>", "14", 
      RowBox[{"-", "246"}], "8", 
      RowBox[{"-", "37"}], "45", 
      RowBox[{"-", "10"}], 
      RowBox[{"-", "2"}], 
      RowBox[{"-", "21"}], 
      RowBox[{"-", "14"}], 
      RowBox[{"-", "8"}], 
      RowBox[{"-", "50"}], 
      RowBox[{"-", "114"}], 
      RowBox[{"-", "40"}], "3", 
      RowBox[{"-", "56"}], "527", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.919686436444112*^9, 3.919686577027645*^9, 
  3.920451456372366*^9, 3.9334060150288982`*^9, 3.9334070461161065`*^9},
 CellLabel->
  "Out[92]//MatrixForm=",ExpressionUUID->"f9e4a4a6-bd71-4385-83c8-\
9bd92fe43e6e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<Marine Pollution\\\\Results\\\\compStat.csv\>\"", ",", "compStat"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.919686098356823*^9, 3.919686099944233*^9}, {
   3.919686147321414*^9, 3.9196861722200007`*^9}, 3.9196863488147106`*^9, {
   3.9278832186080627`*^9, 
   3.9278832192445683`*^9}},ExpressionUUID->"2bfdcfbb-e90a-497f-a544-\
2bdefe0908da"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"baseline", " ", "unconstrained"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"solA", "=", 
    RowBox[{"FindRoot", "[", 
     RowBox[{
      RowBox[{"grandFOC", "[", 
       RowBox[{"a", ",", "T", ",", "b", ",", "c"}], "]"}], ",", 
      RowBox[{"Transpose", "@", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "a", "}"}], ",", 
           RowBox[{"Transpose", "@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.9", ",", 
                RowBox[{"-", "2"}], ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}]}]}], 
          "}"}], ",", "1"}], "]"}]}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"solU", "=", 
    RowBox[{
     RowBox[{"NMaximize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"VV", "[", 
          RowBox[{"a", ",", "T", ",", "b"}], "]"}], ",", 
         RowBox[{"a", "\[LessEqual]", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"0.9999", ",", "NN"}], "]"}]}], ",", 
         RowBox[{"a", "\[GreaterEqual]", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "NN"}], "]"}]}]}], "}"}], ",", "a"}], 
      "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "All", ",", "2"}], "]"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.890637253694556*^9, 3.890637255312444*^9}, {
   3.8906373244456496`*^9, 3.890637327374915*^9}, {3.8906373581061125`*^9, 
   3.890637361309214*^9}, {3.890637659390372*^9, 3.890637673429724*^9}, {
   3.890637752869373*^9, 3.8906377665763702`*^9}, {3.8906383480718756`*^9, 
   3.8906383539158196`*^9}, {3.8906394543037033`*^9, 3.890639460820712*^9}, {
   3.8906395042373095`*^9, 3.8906397657200537`*^9}, {3.890639821887915*^9, 
   3.8906398556325893`*^9}, {3.8906402142851553`*^9, 
   3.8906402145385113`*^9}, {3.8906402491581216`*^9, 3.890640249333103*^9}, {
   3.8906421783810997`*^9, 3.8906421786498313`*^9}, 3.8906449556420712`*^9, {
   3.890645002741973*^9, 3.8906450463277473`*^9}, 3.8908846314206953`*^9, {
   3.89314769678535*^9, 3.893147723850268*^9}, {3.919686604224587*^9, 
   3.919686614336747*^9}, {3.9196867106693153`*^9, 3.919686734252287*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"775f67de-307a-42be-b891-4c78b33a65d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"positive", " ", "abatement"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"solpA1", "=", 
    RowBox[{
     RowBox[{"FindRoot", "[", 
      RowBox[{
       RowBox[{"grandFOC", "[", 
        RowBox[{"a", ",", "T", ",", "b", ",", "c"}], "]"}], ",", 
       RowBox[{"Transpose", "@", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "a", "}"}], ",", 
            RowBox[{"Transpose", "@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0.6", ",", "0", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "NN"}], "}"}]}], "]"}]}]}], "}"}], ",", 
          "1"}], "]"}]}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"solpA", "=", 
    RowBox[{
     RowBox[{"NMaximize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"VV", "[", 
          RowBox[{"a", ",", "T", ",", "b"}], "]"}], ",", 
         RowBox[{"a", "\[LessEqual]", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"0.99999", ",", "NN"}], "]"}]}], ",", 
         RowBox[{"a", "\[GreaterEqual]", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", "NN"}], "]"}]}]}], "}"}], ",", "a"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "All", ",", "2"}], "]"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.890637253694556*^9, 3.890637255312444*^9}, {
   3.8906373244456496`*^9, 3.890637327374915*^9}, {3.8906373581061125`*^9, 
   3.890637361309214*^9}, {3.890637659390372*^9, 3.890637673429724*^9}, {
   3.890637752869373*^9, 3.8906377665763702`*^9}, {3.8906383480718756`*^9, 
   3.8906383539158196`*^9}, {3.8906394543037033`*^9, 3.890639460820712*^9}, {
   3.8906395042373095`*^9, 3.8906397657200537`*^9}, {3.890639821887915*^9, 
   3.8906398556325893`*^9}, {3.8906402142851553`*^9, 
   3.8906402145385113`*^9}, {3.8906402491581216`*^9, 3.890640249333103*^9}, {
   3.8906421783810997`*^9, 3.8906421786498313`*^9}, 3.8906449556420712`*^9, {
   3.890645002741973*^9, 3.8906450463277473`*^9}, {3.8908846314206953`*^9, 
   3.8908846348218613`*^9}, 3.8931476967873497`*^9, 3.8931477270364447`*^9, {
   3.919686619482654*^9, 3.9196866210024433`*^9}, {3.9196867106733184`*^9, 
   3.9196867342542768`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"1e6f9f13-5022-4d1a-bc40-f91650295d53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"equal", " ", "abatement"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"soleA2", "=", 
    RowBox[{
     RowBox[{"FindRoot", "[", 
      RowBox[{
       RowBox[{"Total", "/@", 
        RowBox[{"V", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"x", ",", "NN"}], "]"}], ",", "T", ",", "b", ",", "c"}], 
         "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0"}], "}"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"soleA", "=", 
    RowBox[{
     RowBox[{"NMaximize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"VV", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"x", ",", "NN"}], "]"}], ",", "T", ",", "b"}], "]"}], ",", 
         RowBox[{"x", "\[LessEqual]", " ", "0.9999"}], ",", 
         RowBox[{"x", "\[GreaterEqual]", 
          RowBox[{"-", "2"}]}]}], "}"}], ",", "x"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "All", ",", "2"}], "]"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.890637253694556*^9, 3.890637255312444*^9}, {
   3.8906373244456496`*^9, 3.890637327374915*^9}, {3.8906373581061125`*^9, 
   3.890637361309214*^9}, {3.890637659390372*^9, 3.890637673429724*^9}, {
   3.890637752869373*^9, 3.8906377665763702`*^9}, {3.8906383480718756`*^9, 
   3.8906383539158196`*^9}, {3.8906394543037033`*^9, 3.890639460820712*^9}, {
   3.8906395042373095`*^9, 3.8906397657200537`*^9}, {3.890639821887915*^9, 
   3.8906398556325893`*^9}, {3.8906402142851553`*^9, 
   3.8906402145385113`*^9}, {3.8906402491581216`*^9, 3.890640249333103*^9}, {
   3.8906421783810997`*^9, 3.8906421786498313`*^9}, 3.8906449556420712`*^9, {
   3.890645002741973*^9, 3.8906450463277473`*^9}, {3.8908846314206953`*^9, 
   3.8908846363403406`*^9}, {3.893147696789432*^9, 3.8931476967914724`*^9}, 
   3.8931477300390396`*^9, {3.9196866265421996`*^9, 3.919686628191582*^9}, {
   3.9196867106763144`*^9, 3.9196867342562857`*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"1ef5d0ba-5fda-453d-912e-6b7f6f640127"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"positive", " ", "value"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"solpV", "=", 
    RowBox[{
     RowBox[{"NMaximize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"VV", "[", 
          RowBox[{"a", ",", "T", ",", "b"}], "]"}], ",", 
         RowBox[{"a", "\[LessEqual]", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"0.99999", ",", "NN"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"vv", "[", 
           RowBox[{"a", ",", "T", ",", "b"}], "]"}], "\[GreaterEqual]", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", "NN"}], "]"}]}], ",", 
         RowBox[{"a", "\[GreaterEqual]", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "NN"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"a", ",", 
          RowBox[{"Table", "[", 
           RowBox[{"0.0", ",", 
            RowBox[{"Length", "@", "a"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"0.1", ",", 
            RowBox[{"Length", "@", "a"}]}], "]"}]}], "}"}]}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "All", ",", "2"}], "]"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.890637253694556*^9, 3.890637255312444*^9}, {
   3.8906373244456496`*^9, 3.890637327374915*^9}, {3.8906373581061125`*^9, 
   3.890637361309214*^9}, {3.890637659390372*^9, 3.890637673429724*^9}, {
   3.890637752869373*^9, 3.8906377665763702`*^9}, {3.8906383480718756`*^9, 
   3.8906383539158196`*^9}, {3.8906394543037033`*^9, 3.890639460820712*^9}, {
   3.8906395042373095`*^9, 3.8906397657200537`*^9}, {3.890639821887915*^9, 
   3.8906398556325893`*^9}, {3.8906402142851553`*^9, 
   3.8906402145385113`*^9}, {3.8906402491581216`*^9, 3.890640249333103*^9}, {
   3.8906421783810997`*^9, 3.8906421786498313`*^9}, 3.8906449556420712`*^9, {
   3.890645002741973*^9, 3.8906450463277473`*^9}, {3.8908846314206953`*^9, 
   3.8908846381114783`*^9}, {3.893147696793544*^9, 3.8931476967944736`*^9}, 
   3.8931477327088337`*^9, {3.8937586031397915`*^9, 3.893758640388407*^9}, 
   3.8937586779467645`*^9, {3.8940060394901185`*^9, 3.894006039625586*^9}, {
   3.894006196099771*^9, 3.8940062225646267`*^9}, {3.8940062641557684`*^9, 
   3.8940063183366394`*^9}, {3.895224121860853*^9, 3.895224151026278*^9}, {
   3.895224202813201*^9, 3.895224203810186*^9}, {3.9196866509019446`*^9, 
   3.919686656822536*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"da25d84e-8a14-4703-a1fa-fc71510414f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"equal", " ", "value"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"soleV", "=", 
    RowBox[{
     RowBox[{"NMaximize", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"VV", "[", 
          RowBox[{"a", ",", "T", ",", "b"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"a", "\[LessEqual]", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"0.9999", ",", "NN"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"vv", "[", 
           RowBox[{"a", ",", "T", ",", "b"}], "]"}], "\[Equal]", 
          RowBox[{"Table", "[", 
           RowBox[{"k", ",", "NN"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"Flatten", "@", 
        RowBox[{"{", 
         RowBox[{"a", ",", "k"}], "}"}]}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "All", ",", "2"}], "]"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.890637253694556*^9, 3.890637255312444*^9}, {
   3.8906373244456496`*^9, 3.890637327374915*^9}, {3.8906373581061125`*^9, 
   3.890637361309214*^9}, {3.890637659390372*^9, 3.890637673429724*^9}, {
   3.890637752869373*^9, 3.8906377665763702`*^9}, {3.8906383480718756`*^9, 
   3.8906383539158196`*^9}, {3.8906394543037033`*^9, 3.890639460820712*^9}, {
   3.8906395042373095`*^9, 3.8906397657200537`*^9}, {3.890639821887915*^9, 
   3.8906398556325893`*^9}, {3.8906402142851553`*^9, 
   3.8906402145385113`*^9}, {3.8906402491581216`*^9, 3.890640249333103*^9}, {
   3.8906421783810997`*^9, 3.8906421786498313`*^9}, 3.8906449556420712`*^9, {
   3.890645002741973*^9, 3.8906450463277473`*^9}, {3.8908846314206953`*^9, 
   3.8908846381114783`*^9}, {3.8931476967954736`*^9, 3.8931476967975435`*^9}, 
   3.893147738332466*^9, {3.895224173243651*^9, 3.895224177065569*^9}, {
   3.91968666414044*^9, 3.9196866697421184`*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"a33ce7c6-4f08-43d0-9e90-822988810768"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Display", " ", "results"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dp", "=", ".01"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"resultsPol", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Name\>\"", ",", "\"\<a\>\"", ",", "\"\<apv\>\"", ",", 
          "\"\<apa\>\"", ",", "\"\<aev\>\"", ",", "\"\<aea\>\"", ",", 
          "\"\<v\>\"", ",", "\"\<vpv\>\"", ",", "\"\<vpa\>\"", ",", 
          "\"\<vev\>\"", ",", "\"\<vea\>\""}], "}"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Transpose", "@", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Append", "[", 
            RowBox[{"countryNames", ",", "\"\<Total\>\""}], "]"}], "}"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"100", "*", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Append", "[", 
                RowBox[{"solU", ",", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"solU", ".", "EE"}], "]"}], "/", 
                  RowBox[{"Total", "@", 
                   RowBox[{"Total", "@", "EE"}]}]}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Append", "[", 
                RowBox[{"solpV", ",", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"solpV", ".", "EE"}], "]"}], "/", 
                  RowBox[{"Total", "@", 
                   RowBox[{"Total", "@", "EE"}]}]}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Append", "[", 
                RowBox[{"solpA", ",", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"solpA", ".", "EE"}], "]"}], "/", 
                  RowBox[{"Total", "@", 
                   RowBox[{"Total", "@", "EE"}]}]}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"Delete", "[", 
                  RowBox[{"soleV", ",", 
                   RowBox[{"-", "1"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{
                    RowBox[{"Delete", "[", 
                    RowBox[{"soleV", ",", 
                    RowBox[{"-", "1"}]}], "]"}], ".", "EE"}], "]"}], "/", 
                  RowBox[{"Total", "@", 
                   RowBox[{"Total", "@", "EE"}]}]}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"Flatten", "@", 
                  RowBox[{"Table", "[", 
                   RowBox[{"soleA", ",", "NN"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Table", "[", 
                    RowBox[{"soleA", ",", "NN"}], "]"}]}], ".", "EE"}], "]"}],
                   "/", 
                  RowBox[{"Total", "@", 
                   RowBox[{"Total", "@", "EE"}]}]}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"vv", "[", 
                  RowBox[{"solU", ",", "T", ",", "b"}], "]"}], ",", 
                 RowBox[{"VV", "[", 
                  RowBox[{"solU", ",", "T", ",", "b"}], "]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"vv", "[", 
                  RowBox[{"solpV", ",", "T", ",", "b"}], "]"}], ",", 
                 RowBox[{"VV", "[", 
                  RowBox[{"solpV", ",", "T", ",", "b"}], "]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"vv", "[", 
                  RowBox[{"solpA", ",", "T", ",", "b"}], "]"}], ",", 
                 RowBox[{"VV", "[", 
                  RowBox[{"solpA", ",", "T", ",", "b"}], "]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"vv", "[", 
                  RowBox[{
                   RowBox[{"Delete", "[", 
                    RowBox[{"soleV", ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", "T", ",", "b"}], "]"}], 
                 ",", 
                 RowBox[{"VV", "[", 
                  RowBox[{
                   RowBox[{"Delete", "[", 
                    RowBox[{"soleV", ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", "T", ",", "b"}], 
                  "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"vv", "[", 
                  RowBox[{
                   RowBox[{"Flatten", "@", 
                    RowBox[{"Table", "[", 
                    RowBox[{"soleA", ",", "NN"}], "]"}]}], ",", "T", ",", 
                   "b"}], "]"}], ",", 
                 RowBox[{"VV", "[", 
                  RowBox[{
                   RowBox[{"Flatten", "@", 
                    RowBox[{"Table", "[", 
                    RowBox[{"soleA", ",", "NN"}], "]"}]}], ",", "T", ",", 
                   "b"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
            ",", "dp"}], "]"}]}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "@", "resultsPol"}]}]}]], "Input",
 CellChangeTimes->{{3.8906281854057016`*^9, 3.8906281977436347`*^9}, {
   3.890628257167145*^9, 3.890628287096001*^9}, 3.8906422308311367`*^9, 
   3.890643567083144*^9, {3.8906436085248694`*^9, 3.890643764200324*^9}, {
   3.890643876108221*^9, 3.8906439208353186`*^9}, 3.890644462159134*^9, {
   3.890644500205469*^9, 3.8906445760014305`*^9}, {3.8906446165957932`*^9, 
   3.890644623453315*^9}, {3.8906446914204683`*^9, 3.8906448576750765`*^9}, {
   3.890644964678412*^9, 3.890644988796256*^9}, {3.8906450997609253`*^9, 
   3.890645107168376*^9}, {3.8906463867003927`*^9, 3.8906463921250906`*^9}, {
   3.89065625421167*^9, 3.8906562572568665`*^9}, {3.893147696799548*^9, 
   3.89314769681481*^9}, {3.893147748433015*^9, 3.893147753150145*^9}, {
   3.894005973187419*^9, 3.894005999063114*^9}, {3.8952242990232115`*^9, 
   3.8952244625137877`*^9}, {3.919686682511048*^9, 3.9196867589853363`*^9}, {
   3.919686797530662*^9, 3.9196868338061414`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"e9ec30d2-4ebd-4b24-8c92-27d611b1b3b1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Name\"\>", "\<\"a\"\>", "\<\"apv\"\>", "\<\"apa\"\>", \
"\<\"aev\"\>", "\<\"aea\"\>", "\<\"v\"\>", "\<\"vpv\"\>", "\<\"vpa\"\>", \
"\<\"vev\"\>", "\<\"vea\"\>"},
     {"\<\"Belgium\"\>", "73.2`", "81.12`", "72.04`", "1.03`", 
      "43.160000000000004`", "0.66`", "0.52`", "0.65`", "0.`", "0.96`"},
     {"\<\"Canada\"\>", "13.61`", "18.64`", "1.1400000000000001`", "0.21`", 
      "43.160000000000004`", "0.19`", "0.64`", "1.61`", "0.`", "1.07`"},
     {"\<\"Denmark\"\>", "72.72`", "74.03`", "70.7`", "89.15`", 
      "43.160000000000004`", "0.47000000000000003`", "0.41000000000000003`", 
      "0.52`", "0.`", "0.64`"},
     {"\<\"France\"\>", "3.0700000000000003`", "17.28`", "0.24`", 
      RowBox[{"-", "2.41`"}], "43.160000000000004`", "4.07`", "2.58`", 
      "4.48`", "0.`", "2.29`"},
     {"\<\"Germany\"\>", 
      RowBox[{"-", "19.66`"}], 
      RowBox[{"-", "11.3`"}], "0.`", "11.83`", "43.160000000000004`", "6.7`", 
      "5.36`", "6.25`", "0.`", "3.19`"},
     {"\<\"Dominican Republic\"\>", "93.54`", "10.74`", "92.38`", "0.06`", 
      "43.160000000000004`", 
      RowBox[{"-", "2.2800000000000002`"}], "0.`", 
      RowBox[{"-", "2.11`"}], "0.`", 
      RowBox[{"-", "0.21`"}]},
     {"\<\"Haiti\"\>", "99.45`", "27.63`", "99.35000000000001`", 
      RowBox[{"-", "0.08`"}], "43.160000000000004`", 
      RowBox[{"-", "0.47000000000000003`"}], "0.`", 
      RowBox[{"-", "0.45`"}], "0.`", "0.`"},
     {"\<\"Ireland\"\>", "50.65`", "38.82`", "50.26`", 
      RowBox[{"-", "0.02`"}], "43.160000000000004`", 
      RowBox[{"-", "0.1`"}], "0.`", 
      RowBox[{"-", "0.07`"}], "0.`", "0.06`"},
     {"\<\"Mexico\"\>", "38.99`", "55.050000000000004`", "28.67`", 
      RowBox[{"-", "0.01`"}], "43.160000000000004`", "3.3000000000000003`", 
      "0.`", "3.84`", "0.`", "1.74`"},
     {"\<\"Morocco\"\>", "57.28`", "17.080000000000002`", "54.81`", "0.64`", 
      "43.160000000000004`", 
      RowBox[{"-", "0.59`"}], "0.`", 
      RowBox[{"-", "0.52`"}], "0.`", 
      RowBox[{"-", "0.29`"}]},
     {"\<\"Netherlands\"\>", "73.01`", "48.63`", "71.34`", "1.54`", 
      "43.160000000000004`", 
      RowBox[{"-", "1.3800000000000001`"}], "0.`", 
      RowBox[{"-", "1.26`"}], "0.`", "0.35000000000000003`"},
     {"\<\"Portugal\"\>", "64.64`", "89.`", "61.04`", "0.44`", 
      "43.160000000000004`", "0.54`", "0.14`", "0.66`", "0.`", "0.55`"},
     {"\<\"Spain\"\>", "40.25`", "52.300000000000004`", "37.800000000000004`", 
      RowBox[{"-", "0.09`"}], "43.160000000000004`", "2.05`", 
      "0.47000000000000003`", "2.24`", "0.`", "1.78`"},
     {"\<\"Sweden\"\>", 
      RowBox[{"-", "5.2700000000000005`"}], 
      RowBox[{"-", "1.6300000000000001`"}], "0.07`", 
      RowBox[{"-", "57.21`"}], "43.160000000000004`", "0.59`", "0.5`", 
      "0.67`", "0.`", "0.55`"},
     {"\<\"United Kingdom\"\>", "19.96`", "27.1`", "18.61`", 
      RowBox[{"-", "0.09`"}], "43.160000000000004`", "0.87`", "0.`", "1.03`", 
      "0.`", 
      RowBox[{"-", "1.42`"}]},
     {"\<\"United States\"\>", 
      RowBox[{"-", "42.730000000000004`"}], "11.52`", "0.`", "0.`", 
      "43.160000000000004`", "47.38`", "16.3`", "42.44`", "0.`", "19.91`"},
     {"\<\"Total\"\>", "64.25`", "24.72`", "66.63`", "0.03`", 
      "43.160000000000004`", "62.01`", "26.92`", "59.980000000000004`", "0.`",
       "31.18`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.9334060779063573`*^9, 3.9334070646500373`*^9},
 CellLabel->
  "Out[100]//MatrixForm=",ExpressionUUID->"b55f2504-266f-4791-88bd-\
7e845a9b96ef"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<resultsPol.csv\>\"", ",", "resultsPol"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8906255709957714`*^9, 3.890625587008482*^9}, {
  3.8906451689470067`*^9, 3.8906451736380606`*^9}, {3.8906562647646065`*^9, 
  3.8906562653830166`*^9}, {3.91968671072456*^9, 3.919686710725562*^9}},
 CellLabel->
  "In[352]:=",ExpressionUUID->"0abfb0a2-2296-475b-baf8-e912c40ec124"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"sensitivity", " ", "--"}], "-", " ", 
    RowBox[{"elasticity", " ", "wrt", " ", "to", " ", "EE"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"compStat", "=", "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "@", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "\"\<Transport Elasticities\>\"", "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{"\"\<\>\"", ",", 
           RowBox[{"NN", "+", "1"}]}], "]"}]}], "]"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Transpose", "@", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "\"\<Unconstrained\>\"", "}"}], ",", "countryNames", 
            ",", 
            RowBox[{"{", "\"\<Total\>\"", "}"}]}], "]"}], "}"}], ",", 
         RowBox[{"Transpose", "@", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Join", "[", 
              RowBox[{"countryNames", ",", 
               RowBox[{"{", "\"\<Total\>\"", "}"}]}], "]"}], "}"}], ",", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"10", "^", "3"}], "*", 
              RowBox[{"Transpose", "@", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Transpose", "@", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"dlVdlE", "[", 
                    RowBox[{"a0", ",", "T", ",", "EE", ",", "b"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Total", "@", 
                    RowBox[{"dlVdlE", "[", 
                    RowBox[{"a0", ",", "T", ",", "EE", ",", "b"}], "]"}]}], 
                    "}"}]}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"Total", "/@", 
                    RowBox[{"dlVdlE", "[", 
                    RowBox[{"a0", ",", "T", ",", "EE", ",", "b"}], "]"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"Total", "@", 
                    RowBox[{"Total", "@", 
                    RowBox[{"dlVdlE", "[", 
                    RowBox[{"a0", ",", "T", ",", "EE", ",", "b"}], "]"}]}]}], 
                    "}"}]}], "]"}], "}"}]}], "]"}]}]}], "]"}]}], "]"}]}]}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Transpose", "@", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "\"\<Positive abatement\>\"", "}"}], ",", 
            "countryNames", ",", 
            RowBox[{"{", "\"\<Total\>\"", "}"}]}], "]"}], "}"}], ",", 
         RowBox[{"Transpose", "@", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Join", "[", 
              RowBox[{"countryNames", ",", 
               RowBox[{"{", "\"\<Total\>\"", "}"}]}], "]"}], "}"}], ",", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"10", "^", "3"}], "*", 
              RowBox[{"Transpose", "@", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Transpose", "@", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"dlVdlE", "[", 
                    RowBox[{"solpA", ",", "T", ",", "EE", ",", "b"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"Total", "@", 
                    RowBox[{"dlVdlE", "[", 
                    RowBox[{"solpA", ",", "T", ",", "EE", ",", "b"}], "]"}]}],
                     "}"}]}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"Total", "/@", 
                    RowBox[{"dlVdlE", "[", 
                    RowBox[{"solpA", ",", "T", ",", "EE", ",", "b"}], "]"}]}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"Total", "@", 
                    RowBox[{"Total", "@", 
                    RowBox[{"dlVdlE", "[", 
                    RowBox[{"solpA", ",", "T", ",", "EE", ",", "b"}], 
                    "]"}]}]}], "}"}]}], "]"}], "}"}]}], "]"}]}]}], "]"}]}], 
           "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.919686914996272*^9, 3.9196869293087215`*^9}, {
   3.919686975053857*^9, 3.9196869906695805`*^9}, {3.9196870724679193`*^9, 
   3.9196870786011086`*^9}, {3.9196873412640495`*^9, 
   3.9196873664817934`*^9}, {3.919687533132639*^9, 3.9196875751663084`*^9}, {
   3.9196876092422943`*^9, 3.919687809583785*^9}, {3.9196878473880463`*^9, 
   3.919688002002097*^9}, 3.919688064530332*^9, {3.919688157017514*^9, 
   3.9196881970234847`*^9}, 3.919694918049985*^9, {3.9196954568089714`*^9, 
   3.919695467736123*^9}, {3.920604452416903*^9, 3.920604458147785*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"449a12f6-0662-48a5-81e7-93bd0ef06e75"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Transport Elasticities\"\>", "\<\"\"\>", "\<\"\"\>", "\<\"\"\>", "\
\<\"\"\>", "\<\"\"\>", "\<\"\"\>", "\<\"\"\>", "\<\"\"\>", "\<\"\"\>", \
"\<\"\"\>", "\<\"\"\>", "\<\"\"\>", "\<\"\"\>", "\<\"\"\>", "\<\"\"\>", "\<\"\
\"\>", "\<\"\"\>"},
     {"\<\"Unconstrained\"\>", "\<\"Belgium\"\>", "\<\"Canada\"\>", \
"\<\"Denmark\"\>", "\<\"France\"\>", "\<\"Germany\"\>", "\<\"Dominican \
Republic\"\>", "\<\"Haiti\"\>", "\<\"Ireland\"\>", "\<\"Mexico\"\>", \
"\<\"Morocco\"\>", "\<\"Netherlands\"\>", "\<\"Portugal\"\>", \
"\<\"Spain\"\>", "\<\"Sweden\"\>", "\<\"United Kingdom\"\>", "\<\"United \
States\"\>", "\<\"Total\"\>"},
     {"\<\"Belgium\"\>", 
      RowBox[{"-", "4"}], "0", "1", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", "0", "0", 
      RowBox[{"-", "1"}]},
     {"\<\"Canada\"\>", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "6", "6"},
     {"\<\"Denmark\"\>", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0"},
     {"\<\"France\"\>", "1", "0", "0", 
      RowBox[{"-", "1"}], "1", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0"},
     {"\<\"Germany\"\>", "0", "0", 
      RowBox[{"-", "11"}], "0", "11", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", 
      RowBox[{"-", "12"}], "0", "0", 
      RowBox[{"-", "13"}]},
     {"\<\"Dominican Republic\"\>", "0", "1", "0", "1", "0", 
      RowBox[{"-", "11"}], "3", "1", "6", "0", "0", "2", "1", "0", "0", "129",
       "133"},
     {"\<\"Haiti\"\>", "0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "5"}], "1", "6", "0", "0", "1", "0", "0", 
      RowBox[{"-", "1"}], "158", "161"},
     {"\<\"Ireland\"\>", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "4"}], "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "3"}], "0", 
      RowBox[{"-", "7"}]},
     {"\<\"Mexico\"\>", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "16"}], "0", "0", "0", "0", "0", "0", "56", "39"},
     {"\<\"Morocco\"\>", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "5"}], "0", "0", "3", "0", "0", "7", "7"},
     {"\<\"Netherlands\"\>", "12", "0", "15", "0", "25", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "47"}], "0", "0", "12", "0", "0", "17"},
     {"\<\"Portugal\"\>", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {"\<\"Spain\"\>", "0", "0", "0", "9", "0", "0", "0", "0", "0", "0", "0", 
      "1", 
      RowBox[{"-", "10"}], "0", "0", "0", "0"},
     {"\<\"Sweden\"\>", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0"},
     {"\<\"United Kingdom\"\>", "11", "0", "9", "1", "10", "0", "0", "8", "0",
       "0", "2", "0", "0", "6", 
      RowBox[{"-", "40"}], "0", "6"},
     {"\<\"United States\"\>", 
      RowBox[{"-", "6"}], 
      RowBox[{"-", "247"}], 
      RowBox[{"-", "5"}], 
      RowBox[{"-", "47"}], 
      RowBox[{"-", "3"}], "0", "0", 
      RowBox[{"-", "26"}], 
      RowBox[{"-", "10"}], 
      RowBox[{"-", "5"}], 
      RowBox[{"-", "3"}], 
      RowBox[{"-", "116"}], 
      RowBox[{"-", "34"}], 
      RowBox[{"-", "5"}], 
      RowBox[{"-", "11"}], "171", 
      RowBox[{"-", "348"}]},
     {"\<\"Total\"\>", "14", 
      RowBox[{"-", "246"}], "8", 
      RowBox[{"-", "37"}], "45", 
      RowBox[{"-", "10"}], 
      RowBox[{"-", "2"}], 
      RowBox[{"-", "21"}], 
      RowBox[{"-", "14"}], 
      RowBox[{"-", "8"}], 
      RowBox[{"-", "50"}], 
      RowBox[{"-", "114"}], 
      RowBox[{"-", "40"}], "3", 
      RowBox[{"-", "56"}], "527", "0"},
     {"\<\"Positive abatement\"\>", "\<\"Belgium\"\>", "\<\"Canada\"\>", \
"\<\"Denmark\"\>", "\<\"France\"\>", "\<\"Germany\"\>", "\<\"Dominican \
Republic\"\>", "\<\"Haiti\"\>", "\<\"Ireland\"\>", "\<\"Mexico\"\>", \
"\<\"Morocco\"\>", "\<\"Netherlands\"\>", "\<\"Portugal\"\>", \
"\<\"Spain\"\>", "\<\"Sweden\"\>", "\<\"United Kingdom\"\>", "\<\"United \
States\"\>", "\<\"Total\"\>"},
     {"\<\"Belgium\"\>", 
      RowBox[{"-", "4"}], "0", "1", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", "0", "0", 
      RowBox[{"-", "1"}]},
     {"\<\"Canada\"\>", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0"},
     {"\<\"Denmark\"\>", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0"},
     {"\<\"France\"\>", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", 
      RowBox[{"-", "2"}]},
     {"\<\"Germany\"\>", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0"},
     {"\<\"Dominican Republic\"\>", "0", "1", "0", "1", "0", 
      RowBox[{"-", "11"}], "3", "1", "5", "0", "0", "2", "1", "0", "0", "2", 
      "5"},
     {"\<\"Haiti\"\>", "0", "0", "0", "0", "0", "1", 
      RowBox[{"-", "5"}], "1", "5", "0", "0", "1", "0", "0", 
      RowBox[{"-", "1"}], "0", "2"},
     {"\<\"Ireland\"\>", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "4"}], "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "3"}], "0", 
      RowBox[{"-", "7"}]},
     {"\<\"Mexico\"\>", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "11"}], "0", "0", "0", "0", "0", "0", "2", 
      RowBox[{"-", "9"}]},
     {"\<\"Morocco\"\>", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "4"}], "0", "0", "3", "0", "0", "0", "0"},
     {"\<\"Netherlands\"\>", "12", "0", "14", "0", "16", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "45"}], "0", "0", "11", "0", "0", "9"},
     {"\<\"Portugal\"\>", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {"\<\"Spain\"\>", "0", "0", "0", "8", "0", "0", "0", "0", "0", "0", "0", 
      "1", 
      RowBox[{"-", "10"}], "0", "0", "0", 
      RowBox[{"-", "1"}]},
     {"\<\"Sweden\"\>", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0"},
     {"\<\"United Kingdom\"\>", "11", "0", "8", "1", "5", "0", "0", "7", "0", 
      "0", "2", "0", "0", "5", 
      RowBox[{"-", "38"}], "0", "3"},
     {"\<\"United States\"\>", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "1"},
     {"\<\"Total\"\>", "19", "2", "23", "11", "22", 
      RowBox[{"-", "9"}], 
      RowBox[{"-", "2"}], "5", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "3"}], 
      RowBox[{"-", "44"}], "2", 
      RowBox[{"-", "5"}], "18", 
      RowBox[{"-", "43"}], "4", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.9196949194261265`*^9, 3.919695410056608*^9, 
  3.9196954706073513`*^9, 3.919695545565404*^9, 3.920453671484404*^9, 
  3.9334070303860316`*^9, 3.933407087995002*^9},
 CellLabel->
  "Out[101]//MatrixForm=",ExpressionUUID->"d080fb14-a604-4608-a092-\
f124cb007ec1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<compStat.csv\>\"", ",", "compStat"}], "]"}]], "Input",
 CellChangeTimes->{{3.919687316208599*^9, 3.9196873207438574`*^9}, 
   3.9204536794282074`*^9},
 CellLabel->"In[89]:=",ExpressionUUID->"bd185135-b846-40b9-ba83-adfe7d6564ab"],

Cell[BoxData["\<\"compStat.csv\"\>"], "Output",
 CellChangeTimes->{3.9204536798980675`*^9},
 CellLabel->"Out[89]=",ExpressionUUID->"5bee0e4b-265e-41e6-aa4b-1c0dd0463993"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"sensitivity", " ", "to", " ", "income", " ", "elasticity"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"countryNames", ",", "\[IndentingNewLine]", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"10", "^", "3"}], "*", 
       RowBox[{"vv", "[", 
        RowBox[{"a0", ",", "T", ",", "b"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Log", "[", "GNI", "]"}], "-", 
         RowBox[{"Total", "[", 
          RowBox[{"b", "*", 
           RowBox[{"Log", "[", "GNI", "]"}]}], "]"}]}], ")"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"10", "^", "3"}], "*", 
       RowBox[{"vv", "[", 
        RowBox[{"a0", ",", "T", ",", "b"}], "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Log", "[", "GNI", "]"}], "-", 
          RowBox[{"Total", "[", 
           RowBox[{"b", "*", 
            RowBox[{"Log", "[", "GNI", "]"}]}], "]"}]}], ")"}], "/", 
        RowBox[{"VV", "[", 
         RowBox[{"a0", ",", "T", ",", "b"}], "]"}]}], "*", "epsilon"}], 
      "]"}]}], "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{"vv", "[", 
      RowBox[{"a0", ",", "T", ",", "b"}], "]"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Log", "[", "GNI", "]"}], "-", 
        RowBox[{"Total", "[", 
         RowBox[{"b", "*", 
          RowBox[{"Log", "[", "GNI", "]"}]}], "]"}]}], ")"}], "/", 
      RowBox[{"VV", "[", 
       RowBox[{"a0", ",", "T", ",", "b"}], "]"}]}], "*", "epsilon"}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Log", "[", "GNI", "]"}], "-", 
      RowBox[{"Total", "[", 
       RowBox[{"b", "*", 
        RowBox[{"Log", "[", "GNI", "]"}]}], "]"}]}], ")"}], "*", 
    RowBox[{
     RowBox[{"vv", "[", 
      RowBox[{"solpA", ",", "T", ",", "b"}], "]"}], "/", 
     RowBox[{"VV", "[", 
      RowBox[{"solpA", ",", "T", ",", "b"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"epsilon", "*", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Log", "[", "GNI", "]"}], "-", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"GNI", "^", "epsilon"}], "*", 
           RowBox[{"Log", "[", "GNI", "]"}]}], "]"}], "/", 
         RowBox[{"Total", "[", 
          RowBox[{"GNI", "^", "epsilon"}], "]"}]}]}], ")"}], ".", 
      RowBox[{"vv", "[", 
       RowBox[{"solpA", ",", "T", ",", "b"}], "]"}]}], "/", 
     RowBox[{"VV", "[", 
      RowBox[{"solpA", ",", "T", ",", "b"}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.9196984414686384`*^9, 3.919698449360856*^9}, {
   3.9196985209840727`*^9, 3.91969854118079*^9}, {3.919698995819788*^9, 
   3.919699109294114*^9}, {3.919699155373806*^9, 3.9196991588647504`*^9}, 
   3.919699239076459*^9, {3.9196992794367437`*^9, 3.919699300273423*^9}, {
   3.919700826927024*^9, 3.9197009073510976`*^9}, {3.9197011472404175`*^9, 
   3.919701175336774*^9}, {3.919701352361676*^9, 3.9197013713699856`*^9}, {
   3.9197020596098423`*^9, 3.919702092182598*^9}, {3.919702666679197*^9, 
   3.91970274129292*^9}, {3.9197027733224196`*^9, 3.9197029026709895`*^9}, {
   3.919704589905188*^9, 3.919704617939427*^9}, {3.919704955830809*^9, 
   3.919704969451088*^9}, 3.919705787194209*^9, {3.919706146551737*^9, 
   3.9197061657712183`*^9}, {3.919706199211122*^9, 3.9197062112452583`*^9}, {
   3.919706266805588*^9, 3.9197062962769794`*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"890460c6-6b1d-44ba-b86a-91479f5e18e5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"Belgium\"\>", ",", "\<\"Canada\"\>", ",", "\<\"Denmark\"\>", 
     ",", "\<\"France\"\>", ",", "\<\"Germany\"\>", 
     ",", "\<\"Dominican Republic\"\>", ",", "\<\"Haiti\"\>", 
     ",", "\<\"Ireland\"\>", ",", "\<\"Mexico\"\>", ",", "\<\"Morocco\"\>", 
     ",", "\<\"Netherlands\"\>", ",", "\<\"Portugal\"\>", 
     ",", "\<\"Spain\"\>", ",", "\<\"Sweden\"\>", 
     ",", "\<\"United Kingdom\"\>", ",", "\<\"United States\"\>"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "15"}], ",", 
     RowBox[{"-", "2"}], ",", 
     RowBox[{"-", "14"}], ",", 
     RowBox[{"-", "29"}], ",", 
     RowBox[{"-", "24"}], ",", "79", ",", "25", ",", "3", ",", 
     RowBox[{"-", "34"}], ",", "18", ",", "26", ",", 
     RowBox[{"-", "16"}], ",", 
     RowBox[{"-", "27"}], ",", 
     RowBox[{"-", "14"}], ",", 
     RowBox[{"-", "7"}], ",", "565"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "24"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "21"}], ",", 
     RowBox[{"-", "45"}], ",", 
     RowBox[{"-", "37"}], ",", "123", ",", "39", ",", "5", ",", 
     RowBox[{"-", "53"}], ",", "28", ",", "40", ",", 
     RowBox[{"-", "25"}], ",", 
     RowBox[{"-", "41"}], ",", 
     RowBox[{"-", "22"}], ",", 
     RowBox[{"-", "10"}], ",", "876"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.919704582424143*^9, 3.9197046194678936`*^9}, 
   3.919704970066639*^9, 3.9197057913202252`*^9, 3.9197061672151604`*^9, 
   3.9197062116218567`*^9, {3.919706290434236*^9, 3.9197063013009453`*^9}, 
   3.9197086768584633`*^9, 3.920453840281145*^9, 3.9334070938430853`*^9},
 CellLabel->
  "Out[102]=",ExpressionUUID->"ff383c64-0f26-4d29-a7d6-04a8cbb4b4f2"],

Cell[BoxData["0.8271348046501085`"], "Output",
 CellChangeTimes->{{3.919704582424143*^9, 3.9197046194678936`*^9}, 
   3.919704970066639*^9, 3.9197057913202252`*^9, 3.9197061672151604`*^9, 
   3.9197062116218567`*^9, {3.919706290434236*^9, 3.9197063013009453`*^9}, 
   3.9197086768584633`*^9, 3.920453840281145*^9, 3.933407093848098*^9},
 CellLabel->
  "Out[103]=",ExpressionUUID->"4f67fed3-f617-4b60-b9f7-f3dab6b6d49d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.02534142073905241`"}], ",", 
   RowBox[{"-", "0.03429634778561839`"}], ",", 
   RowBox[{"-", "0.025374365015328287`"}], ",", 
   RowBox[{"-", "0.05289733539543189`"}], ",", 
   RowBox[{"-", "0.0374386716030874`"}], ",", "0.12260711999921989`", ",", 
   "0.039903052384645595`", ",", "0.0034732891786590577`", ",", 
   RowBox[{"-", "0.06681958811917425`"}], ",", "0.026807594849314567`", ",", 
   "0.03889959014848383`", ",", 
   RowBox[{"-", "0.032588921072943554`"}], ",", 
   RowBox[{"-", "0.04843358787543586`"}], ",", 
   RowBox[{"-", "0.026935865005214558`"}], ",", 
   RowBox[{"-", "0.013047098913635131`"}], ",", "0.8431372411672883`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.919704582424143*^9, 3.9197046194678936`*^9}, 
   3.919704970066639*^9, 3.9197057913202252`*^9, 3.9197061672151604`*^9, 
   3.9197062116218567`*^9, {3.919706290434236*^9, 3.9197063013009453`*^9}, 
   3.9197086768584633`*^9, 3.920453840281145*^9, 3.9334070938520093`*^9},
 CellLabel->
  "Out[104]=",ExpressionUUID->"707826f3-769a-4d80-b9e0-3ded4b1321e1"],

Cell[BoxData["0.6843424274553901`"], "Output",
 CellChangeTimes->{{3.919704582424143*^9, 3.9197046194678936`*^9}, 
   3.919704970066639*^9, 3.9197057913202252`*^9, 3.9197061672151604`*^9, 
   3.9197062116218567`*^9, {3.919706290434236*^9, 3.9197063013009453`*^9}, 
   3.9197086768584633`*^9, 3.920453840281145*^9, 3.933407093854088*^9},
 CellLabel->
  "Out[105]=",ExpressionUUID->"ed8908e0-eed7-40ea-844a-54ddce69e5c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"impact", " ", "of", " ", "income", " ", "yi"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"epsilon", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vv", "[", 
         RowBox[{"a0", ",", "T", ",", "b"}], "]"}], "-", 
        RowBox[{"b", " ", 
         RowBox[{"VV", "[", 
          RowBox[{"a0", ",", "T", ",", "b"}], "]"}]}]}], ")"}], "/", 
      "GNI"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"epsilon", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vv", "[", 
         RowBox[{"solpA", ",", "T", ",", "b"}], "]"}], "-", 
        RowBox[{"b", " ", 
         RowBox[{"VV", "[", 
          RowBox[{"solpA", ",", "T", ",", "b"}], "]"}]}]}], ")"}], "/", 
      "GNI"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"countryNames", ",", "\[IndentingNewLine]", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"10", "^", "3"}], "*", "epsilon", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"vv", "[", 
           RowBox[{"a0", ",", "T", ",", "b"}], "]"}], "/", 
          RowBox[{"VV", "[", 
           RowBox[{"a0", ",", "T", ",", "b"}], "]"}]}], "-", "b"}], " ", 
        ")"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"10", "^", "3"}], "*", "epsilon", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"vv", "[", 
           RowBox[{"solpA", ",", "T", ",", "b"}], "]"}], "/", 
          RowBox[{"VV", "[", 
           RowBox[{"solpA", ",", "T", ",", "b"}], "]"}]}], "-", "b"}], 
        ")"}]}], "]"}]}], "}"}], "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "@", 
    RowBox[{"{", 
     RowBox[{"countryNames", ",", "\[IndentingNewLine]", 
      RowBox[{"epsilon", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"vv", "[", 
           RowBox[{"a0", ",", "T", ",", "b"}], "]"}], "/", 
          RowBox[{"VV", "[", 
           RowBox[{"a0", ",", "T", ",", "b"}], "]"}]}], "-", "b"}], " ", 
        ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"epsilon", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"vv", "[", 
           RowBox[{"solpA", ",", "T", ",", "b"}], "]"}], "/", 
          RowBox[{"VV", "[", 
           RowBox[{"solpA", ",", "T", ",", "b"}], "]"}]}], "-", "b"}], 
        ")"}]}]}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.919703396700199*^9, 3.919703439323531*^9}, {
  3.919703545337591*^9, 3.919703557110466*^9}, {3.919704690426073*^9, 
  3.919704798628112*^9}, {3.9197048352881336`*^9, 3.919704922135968*^9}, {
  3.9197050506228275`*^9, 3.9197050510729537`*^9}, {3.9197050819348383`*^9, 
  3.9197051070733166`*^9}, {3.9197066854114485`*^9, 3.9197067031547594`*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"83c24702-9fab-432a-8fa2-389c1d47bdfe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"Belgium\"\>", ",", "\<\"Canada\"\>", ",", "\<\"Denmark\"\>", 
     ",", "\<\"France\"\>", ",", "\<\"Germany\"\>", 
     ",", "\<\"Dominican Republic\"\>", ",", "\<\"Haiti\"\>", 
     ",", "\<\"Ireland\"\>", ",", "\<\"Mexico\"\>", ",", "\<\"Morocco\"\>", 
     ",", "\<\"Netherlands\"\>", ",", "\<\"Portugal\"\>", 
     ",", "\<\"Spain\"\>", ",", "\<\"Sweden\"\>", 
     ",", "\<\"United Kingdom\"\>", ",", "\<\"United States\"\>"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "6"}], ",", 
     RowBox[{"-", "41"}], ",", 
     RowBox[{"-", "2"}], ",", 
     RowBox[{"-", "13"}], ",", 
     RowBox[{"-", "2"}], ",", 
     RowBox[{"-", "40"}], ",", 
     RowBox[{"-", "8"}], ",", 
     RowBox[{"-", "11"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "17"}], ",", 
     RowBox[{"-", "47"}], ",", "0", ",", 
     RowBox[{"-", "11"}], ",", 
     RowBox[{"-", "6"}], ",", 
     RowBox[{"-", "59"}], ",", "265"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "18"}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "6"}], ",", 
     RowBox[{"-", "39"}], ",", 
     RowBox[{"-", "8"}], ",", 
     RowBox[{"-", "11"}], ",", "7", ",", 
     RowBox[{"-", "16"}], ",", 
     RowBox[{"-", "45"}], ",", "2", ",", 
     RowBox[{"-", "7"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "56"}], ",", "210"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.91970492281048*^9, {3.91970502702891*^9, 3.91970505183171*^9}, {
   3.919705090886278*^9, 3.9197051075671897`*^9}, {3.919706692241455*^9, 
   3.9197067235766907`*^9}, 3.9204540363542104`*^9, 3.9334070968658805`*^9},
 CellLabel->
  "Out[108]=",ExpressionUUID->"c03a2f2e-9007-4204-a49b-000d0ac0bd4d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Belgium\"\>", "\<\"Canada\"\>", "\<\"Denmark\"\>", \
"\<\"France\"\>", "\<\"Germany\"\>", "\<\"Dominican Republic\"\>", "\<\"Haiti\
\"\>", "\<\"Ireland\"\>", "\<\"Mexico\"\>", "\<\"Morocco\"\>", \
"\<\"Netherlands\"\>", "\<\"Portugal\"\>", "\<\"Spain\"\>", "\<\"Sweden\"\>", \
"\<\"United Kingdom\"\>", "\<\"United States\"\>"},
     {
      RowBox[{"-", "0.005582695694739935`"}], 
      RowBox[{"-", "0.0407014560176268`"}], 
      RowBox[{"-", "0.001866167590590564`"}], 
      RowBox[{"-", "0.012524848692752581`"}], 
      RowBox[{"-", "0.0018771815476580007`"}], 
      RowBox[{"-", "0.040483239879305286`"}], 
      RowBox[{"-", "0.008242212104128958`"}], 
      RowBox[{"-", "0.010990865417635335`"}], 
      RowBox[{"-", "0.003522784584030335`"}], 
      RowBox[{"-", "0.016998941912089897`"}], 
      RowBox[{"-", "0.04652126327639144`"}], 
      RowBox[{"-", "0.00024803198542366445`"}], 
      RowBox[{"-", "0.011075310026816264`"}], 
      RowBox[{"-", "0.005525533585038749`"}], 
      RowBox[{"-", "0.05853590047860088`"}], "0.2646964327928286`"},
     {
      RowBox[{"-", "0.005406543751858873`"}], 
      RowBox[{"-", "0.01789677097367998`"}], 
      RowBox[{"-", "0.0007748996083842092`"}], 
      RowBox[{"-", "0.003810748576577339`"}], 
      RowBox[{"-", "0.005577204232476674`"}], 
      RowBox[{"-", "0.03895561631451913`"}], 
      RowBox[{"-", "0.008196448496047053`"}], 
      RowBox[{"-", "0.010545093670275344`"}], "0.006782261753350759`", 
      RowBox[{"-", "0.016167532968827954`"}], 
      RowBox[{"-", "0.04525330181852053`"}], "0.001947437324615545`", 
      RowBox[{"-", "0.007011092528814262`"}], 
      RowBox[{"-", "0.003948207248736713`"}], 
      RowBox[{"-", "0.055514997075164475`"}], "0.2103287581859159`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.91970492281048*^9, {3.91970502702891*^9, 3.91970505183171*^9}, {
   3.919705090886278*^9, 3.9197051075671897`*^9}, {3.919706692241455*^9, 
   3.9197067235766907`*^9}, 3.9204540363542104`*^9, 3.9334070968802156`*^9},
 CellLabel->
  "Out[109]//MatrixForm=",ExpressionUUID->"fd8eeab7-7dbc-48c0-8a49-\
2e1b85a491c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "/@", 
  RowBox[{"(", 
   RowBox[{"epsilon", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{
        RowBox[{"vv", "[", 
         RowBox[{"a0", ",", "T", ",", "b"}], "]"}], "/", "GNI"}], "]"}], "-", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"b", "/", "GNI"}], "}"}]}], ".", 
       RowBox[{"{", 
        RowBox[{"vv", "[", 
         RowBox[{"a0", ",", "T", ",", "b"}], "]"}], "}"}]}]}], ")"}]}], 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.919702909794338*^9, 3.919702958296218*^9}, {
  3.9197029888260756`*^9, 3.9197030198218093`*^9}, {3.9197030505701737`*^9, 
  3.919703058633849*^9}, {3.9197034466632338`*^9, 3.9197034599612865`*^9}, {
  3.919703535456297*^9, 3.9197035703310604`*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"12ec2873-8dc7-40c8-b13b-a3b09cad8a2d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "5.024608519190877`*^-6"}], ",", 
   RowBox[{"-", "0.000012766644947519452`"}], ",", 
   RowBox[{"-", "2.9613984456332896`*^-6"}], ",", 
   RowBox[{"-", "2.2192153800071864`*^-6"}], ",", 
   RowBox[{"-", "2.3464047385409382`*^-7"}], ",", 
   RowBox[{"-", "0.00011614694792001673`"}], ",", 
   RowBox[{"-", "0.0001414414272728624`"}], ",", 
   RowBox[{"-", "0.000017060359317781078`"}], ",", 
   RowBox[{"-", "8.732498027840353`*^-7"}], ",", 
   RowBox[{"-", "0.00003206851254185356`"}], ",", 
   RowBox[{"-", "0.000025966205965988725`"}], ",", 
   RowBox[{"-", "4.209704592040786`*^-7"}], ",", 
   RowBox[{"-", "3.5407655115714423`*^-6"}], ",", 
   RowBox[{"-", "5.384900032415764`*^-6"}], ",", 
   RowBox[{"-", "0.000010910183526403012`"}], ",", "7.016586443110492`*^-6"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.9197029054160075`*^9, 3.9197029588761024`*^9}, 
   3.9197029897232985`*^9, 3.919703059165412*^9, {3.9197034494873505`*^9, 
   3.919703460301076*^9}, {3.919703552757659*^9, 3.919703570825892*^9}, 
   3.9197045786556845`*^9, 3.9334071004613*^9},
 CellLabel->
  "Out[110]=",ExpressionUUID->"c162aa8f-7044-4268-bcd6-678a54a2e2ed"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Log", "[", "GNI", "]"}], "*", 
  RowBox[{"(", 
   RowBox[{"1", "-", "b"}], ")"}], "*", 
  RowBox[{"vv", "[", 
   RowBox[{"a0", ",", "T", ",", "b"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"Log", "[", "GNI", "]"}], "*", 
   RowBox[{"(", 
    RowBox[{"1", "-", "b"}], ")"}], "*", 
   RowBox[{"vv", "[", 
    RowBox[{"a0", ",", "T", ",", "b"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9196982813286905`*^9, 3.919698312551901*^9}, {
  3.91969864276094*^9, 3.919698644727453*^9}, {3.9196987082436094`*^9, 
  3.91969871748197*^9}, {3.9196988270596833`*^9, 3.9196988788160653`*^9}, {
  3.9196989183254366`*^9, 3.9196989434558783`*^9}, {3.9196991266764507`*^9, 
  3.9196991302703543`*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"5c34664a-d3c2-4bbc-b4b3-c4eee5af4803"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.04255682646489616`", ",", "0.013903035979369427`", ",", 
   "0.027907600364406048`", ",", "0.3060266719926771`", ",", 
   "0.5075220534016271`", ",", 
   RowBox[{"-", "0.12165966629152616`"}], ",", 
   RowBox[{"-", "0.016896697860805342`"}], ",", 
   RowBox[{"-", "0.006143673716991953`"}], ",", "0.2438577724641852`", ",", 
   RowBox[{"-", "0.03417336611498282`"}], ",", 
   RowBox[{"-", "0.09437244764331898`"}], ",", "0.031543002991998415`", ",", 
   "0.14835857548121534`", ",", "0.03754031023098062`", ",", 
   "0.06538260354645102`", ",", "2.436589045508067`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.919698324557107*^9, 3.919698661205646*^9, {3.9196987116586637`*^9, 
   3.919698717839077*^9}, {3.9196988518286357`*^9, 3.9196988795196486`*^9}, {
   3.919698933114081*^9, 3.919698946025751*^9}, 3.9196991308801403`*^9, 
   3.9334071024445047`*^9},
 CellLabel->
  "Out[111]=",ExpressionUUID->"baca5a4a-01d1-42a8-8903-cc7981e62699"],

Cell[BoxData["3.5879416467982486`"], "Output",
 CellChangeTimes->{
  3.919698324557107*^9, 3.919698661205646*^9, {3.9196987116586637`*^9, 
   3.919698717839077*^9}, {3.9196988518286357`*^9, 3.9196988795196486`*^9}, {
   3.919698933114081*^9, 3.919698946025751*^9}, 3.9196991308801403`*^9, 
   3.9334071024485044`*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"5e205d68-5f53-4bff-ad4f-033bb20d438b"]
}, Open  ]]
},
WindowSize->{1141.2, 568.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
Magnification:>0.8 Inherited,
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d9aaa12a-6d48-4fbd-9b31-86b470f20e3d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 223, 3, 22, "Input",ExpressionUUID->"a675de87-14d1-4229-a029-a4bf07f08cf7"],
Cell[784, 25, 7541, 152, 226, "Input",ExpressionUUID->"9b579936-886d-49da-aebe-dc5cb9b83a7f"],
Cell[8328, 179, 9010, 195, 283, "Input",ExpressionUUID->"5cd9e40e-2e85-4ce0-abd1-f17664df92e3"],
Cell[17341, 376, 9426, 202, 196, "Input",ExpressionUUID->"44fbf54b-5c0d-45a7-9128-3fadd566568f"],
Cell[26770, 580, 1397, 34, 39, "Input",ExpressionUUID->"373153d2-7bc2-44c1-b98f-8cd08ff34fec"],
Cell[CellGroupData[{
Cell[28192, 618, 177, 2, 22, "Input",ExpressionUUID->"b0008732-c2a7-43d8-a7cf-02354bf8962c"],
Cell[28372, 622, 727, 13, 25, "Output",ExpressionUUID->"1e4f9f7c-73e4-493e-b13a-43a3ebcc2c48"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29136, 640, 5295, 110, 219, "Input",ExpressionUUID->"4431e23e-b405-400d-b639-985e04aa39e4"],
Cell[34434, 752, 3850, 78, 275, "Output",ExpressionUUID->"93033e9c-9a9f-4440-89cb-fab470fe211d"]
}, Open  ]],
Cell[38299, 833, 350, 9, 22, "Input",ExpressionUUID->"dacb7170-c524-4360-8a02-bd7783a1b9d1"],
Cell[CellGroupData[{
Cell[38674, 846, 2518, 57, 83, "Input",ExpressionUUID->"771bee0e-c047-4d43-bffc-7a5b5b2f9f39"],
Cell[41195, 905, 4107, 96, 274, "Output",ExpressionUUID->"f9e4a4a6-bd71-4385-83c8-9bd92fe43e6e"]
}, Open  ]],
Cell[45317, 1004, 423, 10, 22, "Input",ExpressionUUID->"2bfdcfbb-e90a-497f-a544-2bdefe0908da"],
Cell[45743, 1016, 2513, 58, 54, "Input",ExpressionUUID->"775f67de-307a-42be-b891-4c78b33a65d7"],
Cell[48259, 1076, 2539, 58, 54, "Input",ExpressionUUID->"1e6f9f13-5022-4d1a-bc40-f91650295d53"],
Cell[50801, 1136, 2186, 49, 54, "Input",ExpressionUUID->"1ef5d0ba-5fda-453d-912e-6b7f6f640127"],
Cell[52990, 1187, 2588, 53, 39, "Input",ExpressionUUID->"da25d84e-8a14-4703-a1fa-fc71510414f9"],
Cell[55581, 1242, 1974, 40, 84, "Input",ExpressionUUID->"a33ce7c6-4f08-43d0-9e90-822988810768"],
Cell[CellGroupData[{
Cell[57580, 1286, 6742, 149, 249, "Input",ExpressionUUID->"e9ec30d2-4ebd-4b24-8c92-27d611b1b3b1"],
Cell[64325, 1437, 3935, 79, 274, "Output",ExpressionUUID->"b55f2504-266f-4791-88bd-7e845a9b96ef"]
}, Open  ]],
Cell[68275, 1519, 436, 9, 22, "Input",ExpressionUUID->"0abfb0a2-2296-475b-baf8-e912c40ec124"],
Cell[CellGroupData[{
Cell[68736, 1532, 5223, 121, 174, "Input",ExpressionUUID->"449a12f6-0662-48a5-81e7-93bd0ef06e75"],
Cell[73962, 1655, 7362, 161, 541, "Output",ExpressionUUID->"d080fb14-a604-4608-a092-f124cb007ec1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81361, 1821, 283, 5, 22, "Input",ExpressionUUID->"bd185135-b846-40b9-ba83-adfe7d6564ab"],
Cell[81647, 1828, 170, 2, 25, "Output",ExpressionUUID->"5bee0e4b-265e-41e6-aa4b-1c0dd0463993"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81854, 1835, 3674, 91, 144, "Input",ExpressionUUID->"890460c6-6b1d-44ba-b86a-91479f5e18e5"],
Cell[85531, 1928, 1760, 41, 41, "Output",ExpressionUUID->"ff383c64-0f26-4d29-a7d6-04a8cbb4b4f2"],
Cell[87294, 1971, 419, 6, 25, "Output",ExpressionUUID->"4f67fed3-f617-4b60-b9f7-f3dab6b6d49d"],
Cell[87716, 1979, 1099, 21, 25, "Output",ExpressionUUID->"707826f3-769a-4d80-b9e0-3ded4b1321e1"],
Cell[88818, 2002, 419, 6, 25, "Output",ExpressionUUID->"ed8908e0-eed7-40ea-844a-54ddce69e5c9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89274, 2013, 2944, 79, 144, "Input",ExpressionUUID->"83c24702-9fab-432a-8fa2-389c1d47bdfe"],
Cell[92221, 2094, 1843, 48, 41, "Output",ExpressionUUID->"c03a2f2e-9007-4204-a49b-000d0ac0bd4d"],
Cell[94067, 2144, 2548, 55, 62, "Output",ExpressionUUID->"fd8eeab7-7dbc-48c0-8a49-2e1b85a491c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96652, 2204, 895, 23, 22, "Input",ExpressionUUID->"12ec2873-8dc7-40c8-b13b-a3b09cad8a2d"],
Cell[97550, 2229, 1200, 24, 47, "Output",ExpressionUUID->"c162aa8f-7044-4268-bcd6-678a54a2e2ed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98787, 2258, 849, 20, 38, "Input",ExpressionUUID->"5c34664a-d3c2-4bbc-b4b3-c4eee5af4803"],
Cell[99639, 2280, 985, 19, 25, "Output",ExpressionUUID->"baca5a4a-01d1-42a8-8903-cc7981e62699"],
Cell[100627, 2301, 400, 7, 25, "Output",ExpressionUUID->"5e205d68-5f53-4bff-ad4f-033bb20d438b"]
}, Open  ]]
}
]
*)

